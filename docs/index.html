<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.5">
<title>ml4opf API documentation</title>
<meta name="description" content="ML4OPF: Machine Learning for OPF
…">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source > summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible;min-width:max-content}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin:1em 0}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], processEscapes: true } });</script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML" integrity="sha256-kZafAc6mZvK3W3v1pHOcUix30OHQN6pU/NO2oFkqZVw=" crossorigin></script>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
/* Collapse source docstrings */
setTimeout(() => {
[...document.querySelectorAll('.hljs.language-python > .hljs-string')]
.filter(el => el.innerHTML.length > 200 && ['"""', "'''"].includes(el.innerHTML.substring(0, 3)))
.forEach(el => {
let d = document.createElement('details');
d.classList.add('hljs-string');
d.innerHTML = '<summary>"""</summary>' + el.innerHTML.substring(3);
el.replaceWith(d);
});
}, 100);
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Package <code>ml4opf</code></h1>
</header>
<section id="section-intro">
<h2 id="ml4opf-machine-learning-for-opf">ML4OPF: Machine Learning for OPF</h2>
<p>This repository contains a collection of tools for applying machine learning
to the optimal power flow (OPF) problem. Below are some common usage patterns:</p>
<h2 id="loading-data">Loading data</h2>
<p>This is probably the most common usage, especially for those who
already have their own models and wish to evaluate on the PGLearn
datasets. ML4OPF makes loading data and splitting training/testing sets
easy and reproducible.</p>
<pre><code class="language-python">from ml4opf import DCProblem

data_dir = ... # path to folder containing the data

problem = DCProblem(data_dir, **kwargs)

# extract tensors
train_pd = problem.train_data[&quot;input/pd&quot;]
train_pg = problem.train_data[&quot;primal/pg&quot;]
train_va = problem.train_data[&quot;primal/va&quot;]

test_pd = problem.test_data[&quot;input/pd&quot;]
test_pg = problem.test_data[&quot;primal/pg&quot;]
test_va = problem.test_data[&quot;primal/va&quot;]

# create a PyTorch dataset
torch_dataset, slices = problem.make_dataset()
</code></pre>
<h2 id="computing-residuals">Computing residuals</h2>
<p>The ML4OPF OPFViolation modules provide a fast (using <code>torch.jit</code>),
standard, and convenient way to: calculate the residuals/violations
of the OPF constraints, compute the objective function,
and other useful problem data such as incidence matrices.</p>
<pre><code class="language-python">v = problem.violation
pg_lower, pg_upper = v.pg_bound_residual(train_pg) # supply clamp=True to report violations only
obj = v.objective(train_pg)
gen_incidence = v.generator_incidence
</code></pre>
<p>Note that you can use the underlying functions directly without instantiating
the OPFViolation class by accessing <code><a title="ml4opf.functional" href="functional/index.html">ml4opf.functional</a></code>.
This allows to perform the calculations without using the data parsing or caching logic,
but requires the user to adopt the functional interface (<code><a title="ml4opf.functional" href="functional/index.html">ml4opf.functional</a></code>) vs. the object-oriented interface (<code><a title="ml4opf.formulations" href="formulations/index.html">ml4opf.formulations</a></code>).</p>
<pre><code class="language-python">import ml4opf.functional as MOF
gen_incidence = MOF.generator_incidence(v.gen_bus, v.n_bus, v.n_gen)
obj = MOF.DCP.objective(train_pg, v.c0, v.c1)
</code></pre>
<h2 id="implementing-an-opfmodel">Implementing an OPFModel</h2>
<p>In order to use the ML4OPF evaluation tools, you need to subclass the
<code><a title="ml4opf.OPFModel" href="#ml4opf.OPFModel">OPFModel</a></code> class and implement a few methods. The typical pattern is to
first write your model in the typical PyTorch fashion - subclassing <code>torch.nn.Module</code>.
Then, subclass <code><a title="ml4opf.OPFModel" href="#ml4opf.OPFModel">OPFModel</a></code> and implement the required methods. Below is an example
where the original model is <code>MyPyTorchModel</code> and the wrapper is <code>MyDCPModel</code>.</p>
<pre><code class="language-python">import torch
from ml4opf import DCPModel

N_LOADS = problem.violation.n_load
N_GEN = problem.violation.n_gen
N_BUS = problem.violation.n_bus

class MyPyTorchModel(torch.nn.Module):
    def __init__(self):
        super().__init__()
        self.fc1 = torch.nn.Linear(N_LOADS, 16)
        self.fc2 = torch.nn.Linear(16, N_GEN)
        self.fc3 = torch.nn.Linear(16, N_BUS)

    def forward(self, pd):
        x = torch.relu(self.fc1(pd))
        pg_pred = self.fc2(x)
        va_pred = self.fc3(x)
        return pg_pred, va_pred

class MyDCPModel(DCPModel):
    def __init__(self, pytorch_model, problem):
        super().__init__()
        self.model = pytorch_model
        self.problem = problem

    def save_checkpoint(self, path_to_folder):
        torch.save(self.model.state_dict(), f&quot;{path_to_folder}/model.pth&quot;)

    @classmethod
    def load_from_checkpoint(cls, path_to_folder, problem):
        pytorch_model = MyPyTorchModel()
        pytorch_model.load_state_dict(torch.load(f&quot;{path_to_folder}/model.pth&quot;))
        return cls(pytorch_model, problem)

    def predict(self, pd):
        pg, va = self.model(pd)
        return {&quot;pg&quot;: pg, &quot;va&quot;: va}
</code></pre>
<h2 id="using-repair-layers">Using repair layers</h2>
<p>A common issue with learning OPF is that the model may predict
infeasible solutions. The <code><a title="ml4opf.layers" href="layers/index.html">ml4opf.layers</a></code> module provides a collection
of differentiable layers that can be used to repair infeasible solutions. For example,
the <code><a title="ml4opf.BoundRepair" href="#ml4opf.BoundRepair">BoundRepair</a></code> layer can be used to repair solutions that violate
bound constraints. The output of <code><a title="ml4opf.BoundRepair" href="#ml4opf.BoundRepair">BoundRepair</a></code> is guaranteed to be within
the specified bounds.</p>
<pre><code class="language-python">from ml4opf.layers import BoundRepair

class BoundRepairPyTorchModel(torch.nn.Module):
    def __init__(self):
        super().__init__()
        self.fc1 = torch.nn.Linear(N_LOADS, 16)
        self.fc2 = torch.nn.Linear(16, N_GEN)
        self.fc3 = torch.nn.Linear(16, N_BUS)
        self.bound_repair = BoundRepair(xmin=v.pmin, xmax=v.pmax, method=&quot;softplus&quot;)

    def forward(self, pd):
        x = torch.relu(self.fc1(pd))
        pg_pred = self.bound_repair(self.fc2(x))
        va_pred = self.fc3(x)
        return pg_pred, va_pred
</code></pre>
<p>The source code is organized into
several submodules:</p>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="ml4opf.formulations" href="formulations/index.html">ml4opf.formulations</a></code></dt>
<dd>
<div class="desc"><p>ML4OPF Formulations</p></div>
</dd>
<dt><code class="name"><a title="ml4opf.functional" href="functional/index.html">ml4opf.functional</a></code></dt>
<dd>
<div class="desc"><p>Functional interface</p></div>
</dd>
<dt><code class="name"><a title="ml4opf.layers" href="layers/index.html">ml4opf.layers</a></code></dt>
<dd>
<div class="desc"><p>ML4OPF Layers</p></div>
</dd>
<dt><code class="name"><a title="ml4opf.loss_functions" href="loss_functions/index.html">ml4opf.loss_functions</a></code></dt>
<dd>
<div class="desc"><p>ML4OPF Loss Functions</p></div>
</dd>
<dt><code class="name"><a title="ml4opf.models" href="models/index.html">ml4opf.models</a></code></dt>
<dd>
<div class="desc"><p>ML4OPF Models
…</p></div>
</dd>
<dt><code class="name"><a title="ml4opf.parsers" href="parsers/index.html">ml4opf.parsers</a></code></dt>
<dd>
<div class="desc"><p>ML4OPF Parsers</p></div>
</dd>
<dt><code class="name"><a title="ml4opf.viz" href="viz/index.html">ml4opf.viz</a></code></dt>
<dd>
<div class="desc"><p>Visualization utilities (plots &amp; tables)</p></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="ml4opf.ACModel"><code class="flex name class">
<span>class <span class="ident">ACModel</span></span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ac/model.py#L13-L139" class="git-link">Browse git</a></div>
<div class="desc"><p><code><a title="ml4opf.OPFModel" href="#ml4opf.OPFModel">OPFModel</a></code> for ACOPF</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.model.OPFModel" href="formulations/model.html#ml4opf.formulations.model.OPFModel">OPFModel</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.ac.model.PerfectACPModel" href="formulations/ac/model.html#ml4opf.formulations.ac.model.PerfectACPModel">PerfectACPModel</a></li>
<li><a title="ml4opf.models.basic_nn.acopf_basic_nn.ACBasicNeuralNet" href="models/basic_nn/acopf_basic_nn.html#ml4opf.models.basic_nn.acopf_basic_nn.ACBasicNeuralNet">ACBasicNeuralNet</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="ml4opf.ACModel.problem"><code class="name">var <span class="ident">problem</span> : <a title="ml4opf.formulations.ac.problem.ACProblem" href="formulations/ac/problem.html#ml4opf.formulations.ac.problem.ACProblem">ACProblem</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ml4opf.ACModel.violation"><code class="name">var <span class="ident">violation</span> : <a title="ml4opf.formulations.ac.violation.ACViolation" href="formulations/ac/violation.html#ml4opf.formulations.ac.violation.ACViolation">ACViolation</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.ACModel.evaluate_model"><code class="name flex">
<span>def <span class="ident">evaluate_model</span></span>(<span>self, reduction: str | None = None, inner_reduction: str | None = None) ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ac/model.py#L39-L139" class="git-link">Browse git</a></div>
<div class="desc"><p>Evaluate the model on the test data.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>reduction</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Reduction method for the metrics. Defaults to None. Must be one of "mean", "sum","max", "none".
If specified, each value in the returned dictionary will be a scalar. Otherwise, they are arrays of shape (n_test_samples,)</dd>
<dt><strong><code>inner_reduction</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Reduction method for turning metrics calculated per component to per sample. Defaults to None. Must be one of "mean", "sum","max", "none".</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict[str, Tensor]</code></dt>
<dd>
<p>Dictionary containing Tensor metrics of the model's performance.</p>
<p><code>vm_lower</code>: Lower bound on the voltage magnitude.</p>
<p><code>vm_upper</code>: Upper bound on the voltage magnitude.</p>
<p><code>pg_lower</code>: Lower bound on the real power generation.</p>
<p><code>pg_upper</code>: Upper bound on the real power generation.</p>
<p><code>qg_lower</code>: Lower bound on the reactive power generation.</p>
<p><code>qg_upper</code>: Upper bound on the reactive power generation.</p>
<p><code>thrm_1</code>: Thermal limit violation from</p>
<p><code>thrm_2</code>: Thermal limit violation to</p>
<p><code>p_balance</code>: Active power balance violation.</p>
<p><code>q_balance</code>: Reactive power balance violation.</p>
<p><code>pg_mae</code>: Mean absolute error of the real power generation.</p>
<p><code>qg_mae</code>: Mean absolute error of the reactive power generation.</p>
<p><code>vm_mae</code>: Mean absolute error of the voltage magnitude.</p>
<p><code>va_mae</code>: Mean absolute error of the voltage angle. (if not bus-wise and va not in predictions, skipped)</p>
<p><code>dva_mae</code>: Mean absolute error of the angle difference. (only if not bus-wise)</p>
<p><code>obj_mape</code>: Mean absolute percent error of the objective value.</p>
</dd>
</dl></div>
</dd>
<dt id="ml4opf.ACModel.predict"><code class="name flex">
<span>def <span class="ident">predict</span></span>(<span>self, pd: torch.Tensor, qd: torch.Tensor) ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ac/model.py#L19-L37" class="git-link">Browse git</a></div>
<div class="desc"><p>Predict the ACOPF primal solution for a given set of loads.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power demand per load.</dd>
<dt><strong><code>qd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power demand per load.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict[str, Tensor]</code></dt>
<dd>
<p>Dictionary containing the predicted primal solution.</p>
<p><code>pg</code>: Active power generation per generator or per bus.</p>
<p><code>qg</code>: Reactive power generation per generator or per bus.</p>
<p><code>vm</code>: Voltage magnitude per bus.</p>
<p><code>va</code>: Voltage angle per bus.</p>
</dd>
</dl></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="ml4opf.formulations.model.OPFModel" href="formulations/model.html#ml4opf.formulations.model.OPFModel">OPFModel</a></b></code>:
<ul class="hlist">
<li><code><a title="ml4opf.formulations.model.OPFModel.load_from_checkpoint" href="formulations/model.html#ml4opf.formulations.model.OPFModel.load_from_checkpoint">load_from_checkpoint</a></code></li>
<li><code><a title="ml4opf.formulations.model.OPFModel.save_checkpoint" href="formulations/model.html#ml4opf.formulations.model.OPFModel.save_checkpoint">save_checkpoint</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="ml4opf.ACProblem"><code class="flex name class">
<span>class <span class="ident">ACProblem</span></span>
<span>(</span><span>data_directory: str, dataset_name: str = 'ACOPF', **parse_kwargs)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ac/problem.py#L7-L76" class="git-link">Browse git</a></div>
<div class="desc"><p><code><a title="ml4opf.OPFProblem" href="#ml4opf.OPFProblem">OPFProblem</a></code> for ACOPF</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.problem.OPFProblem" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem">OPFProblem</a></li>
<li>abc.ABC</li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="ml4opf.ACProblem.default_combos"><code class="name">prop <span class="ident">default_combos</span> : dict[str, list[str]]</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ac/problem.py#L53-L64" class="git-link">Browse git</a></div>
<div class="desc"><p>Default combos for ACOPF:</p>
<ul>
<li>
<p>input: pd, qd</p>
</li>
<li>
<p>target: pg, qg, vm, va</p>
</li>
</ul></div>
</dd>
<dt id="ml4opf.ACProblem.default_order"><code class="name">prop <span class="ident">default_order</span> : list[str]</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ac/problem.py#L66-L69" class="git-link">Browse git</a></div>
<div class="desc"><p>Default order for ACOPF: input, target</p></div>
</dd>
<dt id="ml4opf.ACProblem.feasibility_check"><code class="name">prop <span class="ident">feasibility_check</span> : dict[str, str]</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ac/problem.py#L37-L51" class="git-link">Browse git</a></div>
<div class="desc"><p>Default feasibility check for ACOPF:</p>
<ul>
<li>
<p>termination_status: "LOCALLY_SOLVED"</p>
</li>
<li>
<p>primal_status: "FEASIBLE_POINT"</p>
</li>
<li>
<p>dual_status: "FEASIBLE_POINT"</p>
</li>
</ul></div>
</dd>
<dt id="ml4opf.ACProblem.violation"><code class="name">prop <span class="ident">violation</span> : <a title="ml4opf.formulations.ac.violation.ACViolation" href="formulations/ac/violation.html#ml4opf.formulations.ac.violation.ACViolation">ACViolation</a></code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ac/problem.py#L71-L76" class="git-link">Browse git</a></div>
<div class="desc"><p><code>ACPViolation</code> object, created upon first access.</p></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="ml4opf.formulations.problem.OPFProblem" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem">OPFProblem</a></b></code>:
<ul class="hlist">
<li><code><a title="ml4opf.formulations.problem.OPFProblem.make_dataset" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem.make_dataset">make_dataset</a></code></li>
<li><code><a title="ml4opf.formulations.problem.OPFProblem.parse" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem.parse">parse</a></code></li>
<li><code><a title="ml4opf.formulations.problem.OPFProblem.slice_batch" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem.slice_batch">slice_batch</a></code></li>
<li><code><a title="ml4opf.formulations.problem.OPFProblem.slice_tensor" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem.slice_tensor">slice_tensor</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="ml4opf.ACViolation"><code class="flex name class">
<span>class <span class="ident">ACViolation</span></span>
<span>(</span><span>data: dict[str, torch.Tensor])</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ac/violation.py#L11-L338" class="git-link">Browse git</a></div>
<div class="desc"><p><code><a title="ml4opf.OPFViolation" href="#ml4opf.OPFViolation">OPFViolation</a></code> for ACOPF</p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.violation.OPFViolation" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation">OPFViolation</a></li>
<li>torch.nn.modules.module.Module</li>
<li>abc.ABC</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.ACViolation.angle_difference"><code class="name flex">
<span>def <span class="ident">angle_difference</span></span>(<span>self, va: torch.Tensor) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ac/violation.py#L14-L25" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute the angle differences per branch given the voltage angles per bus.</p>
<p><span><span class="MathJax_Preview">
\text{dva} = \boldsymbol{\theta}_{f} - \boldsymbol{\theta}_{t}
</span><script type="math/tex; mode=display">
\text{dva} = \boldsymbol{\theta}_{f} - \boldsymbol{\theta}_{t}
</script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>va</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage angles per bus ( <span><span class="MathJax_Preview">\boldsymbol{\theta}</span><script type="math/tex">\boldsymbol{\theta}</script></span> ). (batch_size, nbus)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Angle differences per branch. (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.ACViolation.balance_residual"><code class="name flex">
<span>def <span class="ident">balance_residual</span></span>(<span>self,<br>pd: torch.Tensor,<br>qd: torch.Tensor,<br>pg: torch.Tensor,<br>qg: torch.Tensor,<br>vm: torch.Tensor,<br>pf: torch.Tensor,<br>pt: torch.Tensor,<br>qf: torch.Tensor,<br>qt: torch.Tensor,<br>clamp: bool = False,<br>embed_method: str = 'pad') ‑> tuple[torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ac/violation.py#L176-L232" class="git-link">Browse git</a></div>
<div class="desc"><p>Calculate the power balance residual.</p>
<p>Component-wise tensors are first embedded to the bus level using <code>embed_method</code>.</p>
<p>The shunt parameters <span><span class="MathJax_Preview"> g_s, b_s </span><script type="math/tex"> g_s, b_s </script></span> are assumed to be constant, matching the reference case.</p>
<p><span><span class="MathJax_Preview"> \text{p_viol} = \text{pg_bus} - \text{pd_bus} - \text{pt_bus} - \text{pf_bus} - \text{gs_bus} \times \text{vm}^2 </span><script type="math/tex; mode=display"> \text{p_viol} = \text{pg_bus} - \text{pd_bus} - \text{pt_bus} - \text{pf_bus} - \text{gs_bus} \times \text{vm}^2 </script></span>
<span><span class="MathJax_Preview"> \text{q_viol} = \text{qg_bus} - \text{qd_bus} - \text{qt_bus} - \text{qf_bus} + \text{bs_bus} \times \text{vm}^2 </span><script type="math/tex; mode=display"> \text{q_viol} = \text{qg_bus} - \text{qd_bus} - \text{qt_bus} - \text{qf_bus} + \text{bs_bus} \times \text{vm}^2 </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power demand per bus. (batch_size, nbus)</dd>
<dt><strong><code>qd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power demand per bus. (batch_size, nbus)</dd>
<dt><strong><code>pg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power generation per generator. (batch_size, ngen)</dd>
<dt><strong><code>qg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power generation per generator. (batch_size, ngen)</dd>
<dt><strong><code>vm</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage magnitude per bus. (batch_size, nbus)</dd>
<dt><strong><code>pf</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power flow from bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>pt</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power flow to bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>qf</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power flow from bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>qt</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power flow to bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Apply an absolute value to the residual. Defaults to False.</dd>
<dt><strong><code>embed_method</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Embedding method for bus-level components. Defaults to 'pad'. Must be one of 'pad', 'dense_matrix', or 'matrix. See <code>IncidenceMixin.*_to_bus</code>.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Power balance residual for active power. (batch_size, nbus)</dd>
<dt><code>Tensor</code></dt>
<dd>Power balance residual for reactive power. (batch_size, nbus)</dd>
</dl></div>
</dd>
<dt id="ml4opf.ACViolation.calc_violations"><code class="name flex">
<span>def <span class="ident">calc_violations</span></span>(<span>self,<br>pd: torch.Tensor,<br>qd: torch.Tensor,<br>pg: torch.Tensor,<br>qg: torch.Tensor,<br>vm: torch.Tensor,<br>va: torch.Tensor | None = None,<br>dva: torch.Tensor | None = None,<br>flows: tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor] | None = None,<br>reduction: str | None = 'mean',<br>clamp: bool = True) ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ac/violation.py#L234-L321" class="git-link">Browse git</a></div>
<div class="desc"><p>Calculate the violation of all the constraints.</p>
<p>The reduction is applied across the component dimension - e.g., 'mean' will do violation.mean(dim=1) where each violation is (batch, components)</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Real power demand. (batch, loads)</dd>
<dt><strong><code>qd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power demand. (batch, loads)</dd>
<dt><strong><code>pg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Real power generation. (batch, gens)</dd>
<dt><strong><code>qg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power generation. (batch, gens)</dd>
<dt><strong><code>vm</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage magnitude. (batch, buses)</dd>
<dt><strong><code>va</code></strong> :&ensp;<code>Tensor</code>, optional</dt>
<dd>Voltage angle. (batch, buses)</dd>
<dt><strong><code>dva</code></strong> :&ensp;<code>Tensor</code>, optional</dt>
<dd>Voltage angle difference. (batch, branches)</dd>
<dt><strong><code>flows</code></strong> :&ensp;<code>tuple[Tensor, Tensor, Tensor, Tensor]</code>, optional</dt>
<dd>Power flows. (pf, pt, qf, qt)</dd>
<dt><strong><code>reduction</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Reduction method. Defaults to 'mean'. Must be one of 'mean', 'sum', 'none'.</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to True.</dd>
</dl>
<h2 id="returns">Returns</h2>
<ul>
<li>dict[str, Tensor]: Dictionary of violations.</li>
</ul>
<p><code>vm_lower</code>: Voltage magnitude lower bound violation.</p>
<p><code>vm_upper</code>: Voltage magnitude upper bound violation.</p>
<p><code>pg_lower</code>: Real power generation lower bound violation.</p>
<p><code>pg_upper</code>: Real power generation upper bound violation.</p>
<p><code>qg_lower</code>: Reactive power generation lower bound violation.</p>
<p><code>qg_upper</code>: Reactive power generation upper bound violation.</p>
<p><code>thrm_1</code>: Thermal limit from violation.</p>
<p><code>thrm_2</code>: Thermal limit to violation.</p>
<p><code>p_balance</code>: Real power balance violation.</p>
<p><code>q_balance</code>: Reactive power balance violation.</p>
<p><code>dva_lower</code>: Voltage angle difference lower bound violation.</p>
<p><code>dva_upper</code>: Voltage angle difference upper bound violation.</p></div>
</dd>
<dt id="ml4opf.ACViolation.dva_bound_residual"><code class="name flex">
<span>def <span class="ident">dva_bound_residual</span></span>(<span>self, dva: torch.Tensor, clamp: bool = False) ‑> tuple[torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ac/violation.py#L86-L100" class="git-link">Browse git</a></div>
<div class="desc"><p>Calculate the voltage angle difference bound residual.</p>
<p><span><span class="MathJax_Preview"> g_{\text{lower}} = \text{angmin} - \text{dva} </span><script type="math/tex; mode=display"> g_{\text{lower}} = \text{angmin} - \text{dva} </script></span>
<span><span class="MathJax_Preview"> g_{\text{upper}} = \text{dva} - \text{angmax} </span><script type="math/tex; mode=display"> g_{\text{upper}} = \text{dva} - \text{angmax} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>dva</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage angle difference per branch. (batch_size, nbranch)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Lower bound residual. (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Upper bound residual. (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.ACViolation.flows_from_voltage"><code class="name flex">
<span>def <span class="ident">flows_from_voltage</span></span>(<span>self, vm: torch.Tensor, dva: torch.Tensor) ‑> tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ac/violation.py#L38-L65" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute the power flows given the voltage magnitude and angle differences.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>vm</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage magnitude per bus ( <span><span class="MathJax_Preview">\mathbf{v}</span><script type="math/tex">\mathbf{v}</script></span> ). (batch_size, nbus)</dd>
<dt><strong><code>dva</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Angle differences per branch ( <span><span class="MathJax_Preview"> \boldsymbol{\theta}_f - \boldsymbol{\theta}_t </span><script type="math/tex"> \boldsymbol{\theta}_f - \boldsymbol{\theta}_t </script></span> ). (batch_size, nbranch)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Real power flow per branch ( <span><span class="MathJax_Preview">\mathbf{p}_f</span><script type="math/tex">\mathbf{p}_f</script></span> ). (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Real power flow per branch ( <span><span class="MathJax_Preview">\mathbf{p}_t</span><script type="math/tex">\mathbf{p}_t</script></span> ). (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Reactive power flow per branch ( <span><span class="MathJax_Preview">\mathbf{q}_f</span><script type="math/tex">\mathbf{q}_f</script></span> ). (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Reactive power flow per branch ( <span><span class="MathJax_Preview">\mathbf{q}_t</span><script type="math/tex">\mathbf{q}_t</script></span> ). (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.ACViolation.flows_from_voltage_bus"><code class="name flex">
<span>def <span class="ident">flows_from_voltage_bus</span></span>(<span>self, vm: torch.Tensor, va: torch.Tensor) ‑> tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ac/violation.py#L67-L84" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute the power flows given the voltage magnitude per bus and voltage angles per bus.</p>
<p>This function computes angle differences then calls <code>ACPViolation.flows_from_voltage</code>.
See the docstring of <code>ACPViolation.flows_from_voltage</code> for more details.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>vm</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage magnitude per bus ( <span><span class="MathJax_Preview">\mathbf{v}</span><script type="math/tex">\mathbf{v}</script></span> ). (batch_size, nbus)</dd>
<dt><strong><code>va</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage angle per bus ( <span><span class="MathJax_Preview">\boldsymbol{\theta}</span><script type="math/tex">\boldsymbol{\theta}</script></span> ). (batch_size, nbus)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Real power flow per branch ( <span><span class="MathJax_Preview">\mathbf{p}_f</span><script type="math/tex">\mathbf{p}_f</script></span> ). (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Real power flow per branch ( <span><span class="MathJax_Preview">\mathbf{p}_t</span><script type="math/tex">\mathbf{p}_t</script></span> ). (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Reactive power flow per branch ( <span><span class="MathJax_Preview">\mathbf{q}_f</span><script type="math/tex">\mathbf{q}_f</script></span> ). (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Reactive power flow per branch ( <span><span class="MathJax_Preview">\mathbf{q}_t</span><script type="math/tex">\mathbf{q}_t</script></span> ). (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.ACViolation.objective"><code class="name flex">
<span>def <span class="ident">objective</span></span>(<span>self, pg: torch.Tensor) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ac/violation.py#L27-L36" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute the objective function given the active power generation per generator.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power generation per generator. (batch_size, ngen)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Objective function value. (batch_size)</dd>
</dl></div>
</dd>
<dt id="ml4opf.ACViolation.pg_bound_residual"><code class="name flex">
<span>def <span class="ident">pg_bound_residual</span></span>(<span>self, pg: torch.Tensor, clamp: bool = False) ‑> tuple[torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ac/violation.py#L118-L132" class="git-link">Browse git</a></div>
<div class="desc"><p>Calculate the active power generation bound residual.</p>
<p><span><span class="MathJax_Preview"> g_{\text{lower}} = \text{pmin} - \text{pg} </span><script type="math/tex; mode=display"> g_{\text{lower}} = \text{pmin} - \text{pg} </script></span>
<span><span class="MathJax_Preview"> g_{\text{upper}} = \text{pg} - \text{pmax} </span><script type="math/tex; mode=display"> g_{\text{upper}} = \text{pg} - \text{pmax} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power generation per generator. (batch_size, ngen)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Lower bound residual. (batch_size, ngen)</dd>
<dt><code>Tensor</code></dt>
<dd>Upper bound residual. (batch_size, ngen)</dd>
</dl></div>
</dd>
<dt id="ml4opf.ACViolation.qg_bound_residual"><code class="name flex">
<span>def <span class="ident">qg_bound_residual</span></span>(<span>self, qg: torch.Tensor, clamp: bool = False) ‑> tuple[torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ac/violation.py#L134-L148" class="git-link">Browse git</a></div>
<div class="desc"><p>Calculate the reactive power generation bound residual.</p>
<p><span><span class="MathJax_Preview"> g_{\text{lower}} = \text{qmin} - \text{qg} </span><script type="math/tex; mode=display"> g_{\text{lower}} = \text{qmin} - \text{qg} </script></span>
<span><span class="MathJax_Preview"> g_{\text{upper}} = \text{qg} - \text{qmax} </span><script type="math/tex; mode=display"> g_{\text{upper}} = \text{qg} - \text{qmax} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>qg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power generation per generator. (batch_size, ngen)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Lower bound residual. (batch_size, ngen)</dd>
<dt><code>Tensor</code></dt>
<dd>Upper bound residual. (batch_size, ngen)</dd>
</dl></div>
</dd>
<dt id="ml4opf.ACViolation.thermal_residual"><code class="name flex">
<span>def <span class="ident">thermal_residual</span></span>(<span>self,<br>pf: torch.Tensor,<br>pt: torch.Tensor,<br>qf: torch.Tensor,<br>qt: torch.Tensor,<br>clamp: bool = False) ‑> tuple[torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ac/violation.py#L150-L174" class="git-link">Browse git</a></div>
<div class="desc"><p>Calculate the thermal limit residual.</p>
<p><span><span class="MathJax_Preview"> g_{\text{thrm}_1} = \text{pf}^2 + \text{qf}^2 - \text{s1max} </span><script type="math/tex; mode=display"> g_{\text{thrm}_1} = \text{pf}^2 + \text{qf}^2 - \text{s1max} </script></span>
<span><span class="MathJax_Preview"> g_{\text{thrm}_2} = \text{pt}^2 + \text{qt}^2 - \text{s2max} </span><script type="math/tex; mode=display"> g_{\text{thrm}_2} = \text{pt}^2 + \text{qt}^2 - \text{s2max} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pf</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power flow from bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>pt</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power flow to bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>qf</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power flow from bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>qt</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power flow to bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Thermal limit residual for from branch. (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Thermal limit residual for to branch. (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.ACViolation.vm_bound_residual"><code class="name flex">
<span>def <span class="ident">vm_bound_residual</span></span>(<span>self, vm: torch.Tensor, clamp: bool = False) ‑> tuple[torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ac/violation.py#L102-L116" class="git-link">Browse git</a></div>
<div class="desc"><p>Calculate the voltage magnitude bound residual.</p>
<p><span><span class="MathJax_Preview"> g_{\text{lower}} = \text{vmin} - \text{vm} </span><script type="math/tex; mode=display"> g_{\text{lower}} = \text{vmin} - \text{vm} </script></span>
<span><span class="MathJax_Preview"> g_{\text{upper}} = \text{vm} - \text{vmax} </span><script type="math/tex; mode=display"> g_{\text{upper}} = \text{vm} - \text{vmax} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>vm</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage magnitude per bus. (batch_size, nbus)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Lower bound residual. (batch_size, nbus)</dd>
<dt><code>Tensor</code></dt>
<dd>Upper bound residual. (batch_size, nbus)</dd>
</dl></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="ml4opf.formulations.violation.OPFViolation" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation">OPFViolation</a></b></code>:
<ul class="hlist">
<li><code><a title="ml4opf.formulations.violation.OPFViolation.adjacency_matrix" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.adjacency_matrix">adjacency_matrix</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_from_incidence" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.branch_from_incidence">branch_from_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_from_to_bus" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.branch_from_to_bus">branch_from_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_incidence" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.branch_incidence">branch_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_to_incidence" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.branch_to_incidence">branch_to_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_to_to_bus" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.branch_to_to_bus">branch_to_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.forward" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.forward">forward</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.gen_to_bus" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.gen_to_bus">gen_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.generator_incidence" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.generator_incidence">generator_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.load_incidence" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.load_incidence">load_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.load_to_bus" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.load_to_bus">load_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.reduce_violation" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.reduce_violation">reduce_violation</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.reduce_violations" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.reduce_violations">reduce_violations</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.violation_shapes" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.violation_shapes">violation_shapes</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="ml4opf.BoundRepair"><code class="flex name class">
<span>class <span class="ident">BoundRepair</span></span>
<span>(</span><span>xmin: torch.Tensor | None,<br>xmax: torch.Tensor | None,<br>method: str = 'relu',<br>sanity_check: bool = True,<br>memory_efficient: int = 0)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/layers/bound_repair.py#L10-L366" class="git-link">Browse git</a></div>
<div class="desc"><p>An activation function that clips the output to a given range.</p>
<p>Initializes the BoundRepair module.</p>
<p>If both <code>xmin</code> and <code>xmax</code> are None, per-sample bounds must be provided as input to the forward method.
In this case <code>memory_efficient</code> is ignored (it is set to 2 regardless).</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>xmin</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Lower bounds for clipping.</dd>
<dt><strong><code>xmax</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Upper bounds for clipping.</dd>
<dt><strong><code>method</code></strong> :&ensp;<code>str</code></dt>
<dd>The method to use for clipping. One of ["relu", "sigmoid", "clamp", "softplus", "tanh", "none"].</dd>
<dt><strong><code>sanity_check</code></strong> :&ensp;<code>bool</code></dt>
<dd>If True, performs sanity checks on the input.</dd>
<dt><strong><code>memory_efficient</code></strong> :&ensp;<code>int</code></dt>
<dd>0: pre-compute masks and pre-index bounds, 1: pre-compute masks, 2: do not pre-compute anything</dd>
</dl></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>torch.nn.modules.module.Module</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="ml4opf.BoundRepair.SUPPORTED_METHODS"><code class="name">var <span class="ident">SUPPORTED_METHODS</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="ml4opf.BoundRepair.double_relu"><code class="name flex">
<span>def <span class="ident">double_relu</span></span>(<span>x: torch.Tensor, xmin: torch.Tensor, xmax: torch.Tensor)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/layers/bound_repair.py#L117-L132" class="git-link">Browse git</a></div>
<div class="desc"><p>ReLU bound repair function for double-sided bounds.</p>
<p><span><span class="MathJax_Preview"> \text{relu}(x - \underline{x}) - \text{relu}(x - \overline{x}) + \underline{x} </span><script type="math/tex; mode=display"> \text{relu}(x - \underline{x}) - \text{relu}(x - \overline{x}) + \underline{x} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>x</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Input tensor.</dd>
<dt><strong><code>xmin</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Lower bound.</dd>
<dt><strong><code>xmax</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Upper bound.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Output tensor satisfying the bounds.</dd>
</dl></div>
</dd>
<dt id="ml4opf.BoundRepair.double_sigmoid"><code class="name flex">
<span>def <span class="ident">double_sigmoid</span></span>(<span>x: torch.Tensor, xmin: torch.Tensor, xmax: torch.Tensor)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/layers/bound_repair.py#L181-L196" class="git-link">Browse git</a></div>
<div class="desc"><p>Sigmoid bound repair function for double-sided bounds.</p>
<p><span><span class="MathJax_Preview"> \text{sigmoid}(x) \cdot (\overline{x} - \underline{x}) + \underline{x} </span><script type="math/tex; mode=display"> \text{sigmoid}(x) \cdot (\overline{x} - \underline{x}) + \underline{x} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>x</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Input tensor.</dd>
<dt><strong><code>xmin</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Lower bound.</dd>
<dt><strong><code>xmax</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Upper bound.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Output tensor satisfying the bounds.</dd>
</dl></div>
</dd>
<dt id="ml4opf.BoundRepair.double_softplus"><code class="name flex">
<span>def <span class="ident">double_softplus</span></span>(<span>x: torch.Tensor, xmin: torch.Tensor, xmax: torch.Tensor)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/layers/bound_repair.py#L211-L226" class="git-link">Browse git</a></div>
<div class="desc"><p>Softplus bound repair function for double-sided bounds.</p>
<p><span><span class="MathJax_Preview"> \text{softplus}(x - \underline{x}) - \text{softplus}(x - \overline{x}) + \underline{x} </span><script type="math/tex; mode=display"> \text{softplus}(x - \underline{x}) - \text{softplus}(x - \overline{x}) + \underline{x} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>x</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Input tensor.</dd>
<dt><strong><code>xmin</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Lower bound.</dd>
<dt><strong><code>xmax</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Upper bound.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Output tensor satisfying the bounds.</dd>
</dl></div>
</dd>
<dt id="ml4opf.BoundRepair.double_tanh"><code class="name flex">
<span>def <span class="ident">double_tanh</span></span>(<span>x: torch.Tensor, xmin: torch.Tensor, xmax: torch.Tensor)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/layers/bound_repair.py#L274-L289" class="git-link">Browse git</a></div>
<div class="desc"><p>Tanh bound repair function for double-sided bounds.</p>
<p><span><span class="MathJax_Preview"> (\frac{1}{2} \tanh(x) + \frac{1}{2}) \cdot (\overline{x} - \underline{x}) + \underline{x} </span><script type="math/tex; mode=display"> (\frac{1}{2} \tanh(x) + \frac{1}{2}) \cdot (\overline{x} - \underline{x}) + \underline{x} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>x</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Input tensor.</dd>
<dt><strong><code>xmin</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Lower bound.</dd>
<dt><strong><code>xmax</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Upper bound.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Output tensor satisfying the bounds.</dd>
</dl></div>
</dd>
<dt id="ml4opf.BoundRepair.lower_relu"><code class="name flex">
<span>def <span class="ident">lower_relu</span></span>(<span>x: torch.Tensor, xmin: torch.Tensor)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/layers/bound_repair.py#L134-L148" class="git-link">Browse git</a></div>
<div class="desc"><p>ReLU bound repair function for lower bounds.</p>
<p><span><span class="MathJax_Preview"> \text{relu}(x - \underline{x}) + \underline{x} </span><script type="math/tex; mode=display"> \text{relu}(x - \underline{x}) + \underline{x} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>x</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Input tensor.</dd>
<dt><strong><code>xmin</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Lower bound.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Output tensor satisfying the bounds.</dd>
</dl></div>
</dd>
<dt id="ml4opf.BoundRepair.lower_softplus"><code class="name flex">
<span>def <span class="ident">lower_softplus</span></span>(<span>x: torch.Tensor, xmin: torch.Tensor)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/layers/bound_repair.py#L228-L242" class="git-link">Browse git</a></div>
<div class="desc"><p>Softplus bound repair function for lower bounds.</p>
<p><span><span class="MathJax_Preview"> \text{softplus}(x - \underline{x}) + \underline{x} </span><script type="math/tex; mode=display"> \text{softplus}(x - \underline{x}) + \underline{x} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>x</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Input tensor.</dd>
<dt><strong><code>xmin</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Lower bound.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Output tensor satisfying the bounds.</dd>
</dl></div>
</dd>
<dt id="ml4opf.BoundRepair.upper_relu"><code class="name flex">
<span>def <span class="ident">upper_relu</span></span>(<span>x: torch.Tensor, xmax: torch.Tensor)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/layers/bound_repair.py#L150-L164" class="git-link">Browse git</a></div>
<div class="desc"><p>ReLU bound repair function for upper bounds.</p>
<p><span><span class="MathJax_Preview"> -\text{relu}(\overline{x} - x) + \overline{x} </span><script type="math/tex; mode=display"> -\text{relu}(\overline{x} - x) + \overline{x} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>x</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Input tensor.</dd>
<dt><strong><code>xmax</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Upper bound.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Output tensor satisfying the bounds.</dd>
</dl></div>
</dd>
<dt id="ml4opf.BoundRepair.upper_softplus"><code class="name flex">
<span>def <span class="ident">upper_softplus</span></span>(<span>x: torch.Tensor, xmax: torch.Tensor)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/layers/bound_repair.py#L244-L258" class="git-link">Browse git</a></div>
<div class="desc"><p>Softplus bound repair function for upper bounds.</p>
<p><span><span class="MathJax_Preview"> -\text{softplus}(\overline{x} - x) + \overline{x} </span><script type="math/tex; mode=display"> -\text{softplus}(\overline{x} - x) + \overline{x} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>x</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Input tensor.</dd>
<dt><strong><code>xmax</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Upper bound.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Output tensor satisfying the bounds.</dd>
</dl></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.BoundRepair.clamp"><code class="name flex">
<span>def <span class="ident">clamp</span></span>(<span>self, x: torch.Tensor)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/layers/bound_repair.py#L104-L115" class="git-link">Browse git</a></div>
<div class="desc"><p>Bound repair function that uses <code>torch.clamp</code>.</p>
<p><span><span class="MathJax_Preview"> \text{clamp}(x, \underline{x}, \overline{x}) </span><script type="math/tex; mode=display"> \text{clamp}(x, \underline{x}, \overline{x}) </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>x</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Input tensor.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Output tensor satisfying the bounds.</dd>
</dl></div>
</dd>
<dt id="ml4opf.BoundRepair.forward"><code class="name flex">
<span>def <span class="ident">forward</span></span>(<span>self,<br>x: torch.Tensor,<br>xmin: torch.Tensor | None = None,<br>xmax: torch.Tensor | None = None) ‑> Callable[..., Any]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/layers/bound_repair.py#L77-L98" class="git-link">Browse git</a></div>
<div class="desc"><p>Applies the bound clipping function to the input.</p></div>
</dd>
<dt id="ml4opf.BoundRepair.load_state_dict"><code class="name flex">
<span>def <span class="ident">load_state_dict</span></span>(<span>self, state_dict: dict, strict: bool = True)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/layers/bound_repair.py#L352-L366" class="git-link">Browse git</a></div>
<div class="desc"><p>Loads the state dictionary and re-initializes the pre-computed quantities.</p></div>
</dd>
<dt id="ml4opf.BoundRepair.none"><code class="name flex">
<span>def <span class="ident">none</span></span>(<span>self, x: torch.Tensor)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/layers/bound_repair.py#L100-L102" class="git-link">Browse git</a></div>
<div class="desc"><p>no-op, just return x</p></div>
</dd>
<dt id="ml4opf.BoundRepair.preprocess_bounds"><code class="name flex">
<span>def <span class="ident">preprocess_bounds</span></span>(<span>self, memory_efficient: int)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/layers/bound_repair.py#L304-L343" class="git-link">Browse git</a></div>
<div class="desc"><p>Pre-computes masks and pre-indexes bounds depending on <code>memory_efficient</code> level.</p>
<h2 id="args">Args</h2>
<p>memory_efficient (int):</p>
<p><code>0</code>: (fastest, most memory) pre-compute masks and index bounds</p>
<p><code>1</code>: pre-compute masks only</p>
<p><code>2</code>: (slowest, least memory) do not pre-compute anything</p></div>
</dd>
<dt id="ml4opf.BoundRepair.relu"><code class="name flex">
<span>def <span class="ident">relu</span></span>(<span>self, x: torch.Tensor)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/layers/bound_repair.py#L166-L179" class="git-link">Browse git</a></div>
<div class="desc"><p>Apply the ReLU-based bound repair functions to the input, supporting any combination of single- or double-sided bounds.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>x</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Input tensor.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Output tensor satisfying the bounds.</dd>
</dl></div>
</dd>
<dt id="ml4opf.BoundRepair.sigmoid"><code class="name flex">
<span>def <span class="ident">sigmoid</span></span>(<span>self, x: torch.Tensor)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/layers/bound_repair.py#L198-L209" class="git-link">Browse git</a></div>
<div class="desc"><p>Apply the sigmoid bound repair function to the input, supporting only unbounded or double-sided bounds.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>x</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Input tensor.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Output tensor satisfying the bounds.</dd>
</dl></div>
</dd>
<dt id="ml4opf.BoundRepair.softplus"><code class="name flex">
<span>def <span class="ident">softplus</span></span>(<span>self, x: torch.Tensor)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/layers/bound_repair.py#L260-L272" class="git-link">Browse git</a></div>
<div class="desc"><p>Apply the softplus bound-clipping function to the input, supporting any combination of single- or double-sided bounds.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>x</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Input tensor.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Output tensor satisfying the bounds.</dd>
</dl></div>
</dd>
<dt id="ml4opf.BoundRepair.tanh"><code class="name flex">
<span>def <span class="ident">tanh</span></span>(<span>self, x: torch.Tensor)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/layers/bound_repair.py#L291-L302" class="git-link">Browse git</a></div>
<div class="desc"><p>Apply the tanh bound-clipping function to the input, supporting only unbounded or double-sided bounds.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>x</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Input tensor.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Output tensor satisfying the bounds.</dd>
</dl></div>
</dd>
</dl>
</dd>
<dt id="ml4opf.DCModel"><code class="flex name class">
<span>class <span class="ident">DCModel</span></span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/dc/model.py#L13-L96" class="git-link">Browse git</a></div>
<div class="desc"><p><code><a title="ml4opf.OPFModel" href="#ml4opf.OPFModel">OPFModel</a></code> for DCOPF</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.model.OPFModel" href="formulations/model.html#ml4opf.formulations.model.OPFModel">OPFModel</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.dc.model.PerfectDCModel" href="formulations/dc/model.html#ml4opf.formulations.dc.model.PerfectDCModel">PerfectDCModel</a></li>
<li><a title="ml4opf.models.basic_nn.dcopf_basic_nn.DCBasicNeuralNet" href="models/basic_nn/dcopf_basic_nn.html#ml4opf.models.basic_nn.dcopf_basic_nn.DCBasicNeuralNet">DCBasicNeuralNet</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="ml4opf.DCModel.problem"><code class="name">var <span class="ident">problem</span> : <a title="ml4opf.formulations.dc.problem.DCProblem" href="formulations/dc/problem.html#ml4opf.formulations.dc.problem.DCProblem">DCProblem</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ml4opf.DCModel.violation"><code class="name">var <span class="ident">violation</span> : <a title="ml4opf.formulations.dc.violation.DCViolation" href="formulations/dc/violation.html#ml4opf.formulations.dc.violation.DCViolation">DCViolation</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.DCModel.evaluate_model"><code class="name flex">
<span>def <span class="ident">evaluate_model</span></span>(<span>self, reduction: str | None = None, inner_reduction: str | None = None) ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/dc/model.py#L34-L96" class="git-link">Browse git</a></div>
<div class="desc"><p>Evaluate the model on the test data.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>reduction</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Reduction method for the metrics. Defaults to None. Must be one of "mean", "sum","max", "none".
If specified, each value in the returned dictionary will be a scalar. Otherwise, they are arrays of shape (n_test_samples,)</dd>
<dt><strong><code>inner_reduction</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Reduction method for turning metrics calculated per component to per sample. Defaults to None. Must be one of "mean", "sum","max", "none".</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict[str, Tensor]</code></dt>
<dd>
<p>Dictionary containing Tensor metrics of the model's performance.</p>
<p><code>pg_lower</code>: Generator lower bound violation.</p>
<p><code>pg_upper</code>: Generator upper bound violation.</p>
<p><code>dva_lower</code>: Angle difference limit lower bound violation.</p>
<p><code>dva_upper</code>: Angle difference limit upper bound violation.</p>
<p><code>pf_lower</code>: Flow limit lower bound violation.</p>
<p><code>pf_upper</code>: Flow limit upper bound violation.</p>
<p><code>p_balance</code>: Power balance violation.</p>
<p><code>pg_mae</code>: Mean absolute error of the real power generation.</p>
<p><code>va_mae</code>: Mean absolute error of the voltage angle. (if not bus-wise and va not in predictions, skipped)</p>
<p><code>pf_mae</code>: Mean absolute error of the real power flow.</p>
<p><code>obj_mape</code>: Mean absolute percent error of the objective value.</p>
</dd>
</dl></div>
</dd>
<dt id="ml4opf.DCModel.predict"><code class="name flex">
<span>def <span class="ident">predict</span></span>(<span>self, pd: torch.Tensor) ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/dc/model.py#L19-L32" class="git-link">Browse git</a></div>
<div class="desc"><p>Predict the DCOPF primal solution for a given set of loads.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power demand per load.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict[str, Tensor]</code></dt>
<dd>
<p>Dictionary containing the predicted primal solution.</p>
<p><code>pg</code>: Active power generation per generator or per bus.</p>
<p><code>va</code>: Voltage angle per bus.</p>
</dd>
</dl></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="ml4opf.formulations.model.OPFModel" href="formulations/model.html#ml4opf.formulations.model.OPFModel">OPFModel</a></b></code>:
<ul class="hlist">
<li><code><a title="ml4opf.formulations.model.OPFModel.load_from_checkpoint" href="formulations/model.html#ml4opf.formulations.model.OPFModel.load_from_checkpoint">load_from_checkpoint</a></code></li>
<li><code><a title="ml4opf.formulations.model.OPFModel.save_checkpoint" href="formulations/model.html#ml4opf.formulations.model.OPFModel.save_checkpoint">save_checkpoint</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="ml4opf.DCProblem"><code class="flex name class">
<span>class <span class="ident">DCProblem</span></span>
<span>(</span><span>data_directory: str, dataset_name: str = 'DCOPF', **parse_kwargs)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/dc/problem.py#L7-L66" class="git-link">Browse git</a></div>
<div class="desc"><p><code><a title="ml4opf.OPFProblem" href="#ml4opf.OPFProblem">OPFProblem</a></code> for DCOPF</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.problem.OPFProblem" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem">OPFProblem</a></li>
<li>abc.ABC</li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="ml4opf.DCProblem.default_combos"><code class="name">prop <span class="ident">default_combos</span> : dict[str, list[str]]</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/dc/problem.py#L43-L54" class="git-link">Browse git</a></div>
<div class="desc"><p>Default combos for DCOPF:</p>
<ul>
<li>
<p>input: pd</p>
</li>
<li>
<p>target: pg, va</p>
</li>
</ul></div>
</dd>
<dt id="ml4opf.DCProblem.default_order"><code class="name">prop <span class="ident">default_order</span> : list[str]</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/dc/problem.py#L56-L59" class="git-link">Browse git</a></div>
<div class="desc"><p>Default order for DCOPF. input, target</p></div>
</dd>
<dt id="ml4opf.DCProblem.feasibility_check"><code class="name">prop <span class="ident">feasibility_check</span> : dict[str, str]</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/dc/problem.py#L27-L41" class="git-link">Browse git</a></div>
<div class="desc"><p>Default feasibility check for DCOPF:</p>
<ul>
<li>
<p>termination_status: "OPTIMAL"</p>
</li>
<li>
<p>primal_status: "FEASIBLE_POINT"</p>
</li>
<li>
<p>dual_status: "FEASIBLE_POINT"</p>
</li>
</ul></div>
</dd>
<dt id="ml4opf.DCProblem.violation"><code class="name">prop <span class="ident">violation</span> : <a title="ml4opf.formulations.dc.violation.DCViolation" href="formulations/dc/violation.html#ml4opf.formulations.dc.violation.DCViolation">DCViolation</a></code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/dc/problem.py#L61-L66" class="git-link">Browse git</a></div>
<div class="desc"><p>OPFViolation object for DCOPF constraint calculations.</p></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="ml4opf.formulations.problem.OPFProblem" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem">OPFProblem</a></b></code>:
<ul class="hlist">
<li><code><a title="ml4opf.formulations.problem.OPFProblem.make_dataset" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem.make_dataset">make_dataset</a></code></li>
<li><code><a title="ml4opf.formulations.problem.OPFProblem.parse" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem.parse">parse</a></code></li>
<li><code><a title="ml4opf.formulations.problem.OPFProblem.slice_batch" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem.slice_batch">slice_batch</a></code></li>
<li><code><a title="ml4opf.formulations.problem.OPFProblem.slice_tensor" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem.slice_tensor">slice_tensor</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="ml4opf.DCViolation"><code class="flex name class">
<span>class <span class="ident">DCViolation</span></span>
<span>(</span><span>data: dict[str, torch.Tensor])</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/dc/violation.py#L11-L225" class="git-link">Browse git</a></div>
<div class="desc"><p><code><a title="ml4opf.OPFViolation" href="#ml4opf.OPFViolation">OPFViolation</a></code> for DCPPowerModel/DCOPF</p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.violation.OPFViolation" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation">OPFViolation</a></li>
<li>torch.nn.modules.module.Module</li>
<li>abc.ABC</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.DCViolation.angle_difference"><code class="name flex">
<span>def <span class="ident">angle_difference</span></span>(<span>self, va: torch.Tensor) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/dc/violation.py#L14-L27" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute the angle differences per branch given the voltage angles per bus.</p>
<p>The branch indices are assumed to be constant for the batch, matching the reference case.</p>
<p><span><span class="MathJax_Preview">
\text{dva} = \boldsymbol{\theta}_{f} - \boldsymbol{\theta}_{t}
</span><script type="math/tex; mode=display">
\text{dva} = \boldsymbol{\theta}_{f} - \boldsymbol{\theta}_{t}
</script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>va</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage angles per bus ( <span><span class="MathJax_Preview">\boldsymbol{\theta}</span><script type="math/tex">\boldsymbol{\theta}</script></span> ). (batch_size, nbus)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Angle differences per branch. (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.DCViolation.balance_residual"><code class="name flex">
<span>def <span class="ident">balance_residual</span></span>(<span>self,<br>pd: torch.Tensor,<br>pg: torch.Tensor,<br>pf: torch.Tensor,<br>embed_method: str = 'pad',<br>clamp: bool = True) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/dc/violation.py#L106-L131" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute power balance residual.</p>
<p><span><span class="MathJax_Preview">
\text{g_balance} = \text{pg_bus} - \text{pd_bus} - \text{gs_bus} - \text{pf_bus} - \text{pt_bus}
</span><script type="math/tex; mode=display">
\text{g_balance} = \text{pg_bus} - \text{pd_bus} - \text{gs_bus} - \text{pf_bus} - \text{pt_bus}
</script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Power demand per bus. (batch_size, nbus)</dd>
<dt><strong><code>pg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Power generation per generator. (batch_size, ngen)</dd>
<dt><strong><code>pf</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Power flow per branch. (batch_size, nbranch)</dd>
<dt><strong><code>embed_method</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Embedding method to convert component-wise values to bus-wise &ndash; one of "pad", "dense_matrix", or "matrix". Defaults to "pad".</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp to extract only violations. Defaults to True.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Power balance residual. (batch_size, nbus)</dd>
</dl></div>
</dd>
<dt id="ml4opf.DCViolation.calc_violations"><code class="name flex">
<span>def <span class="ident">calc_violations</span></span>(<span>self,<br>pd: torch.Tensor,<br>pg: torch.Tensor,<br>va: torch.Tensor,<br>pf: torch.Tensor | None = None,<br>reduction: str = 'mean',<br>clamp: bool = True,<br>embed_method: str = 'pad') ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/dc/violation.py#L150-L212" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute all DCOPF violations.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Power demand per bus. (batch_size, nbus)</dd>
<dt><strong><code>pg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Power generation per generator. (batch_size, ngen)</dd>
<dt><strong><code>va</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage angles per bus. (batch_size, nbus)</dd>
<dt><strong><code>pf</code></strong> :&ensp;<code>Tensor</code>, optional</dt>
<dd>Power flow per branch. Defaults to None.</dd>
<dt><strong><code>reduction</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Reduction method. Defaults to "mean".</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp to extract only violations. Defaults to True.</dd>
<dt><strong><code>embed_method</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Method to convert component-wise values to bus-wise &ndash; one of "pad", "dense_matrix", or "matrix". Defaults to "pad".</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict[str, Tensor]</code></dt>
<dd>Dictionary of all violations:</dd>
</dl>
<ul>
<li>
<p>"pg_lower": Lower bound violation of power generation. (batch_size, ngen)</p>
</li>
<li>
<p>"pg_upper": Upper bound violation of power generation. (batch_size, ngen)</p>
</li>
<li>
<p>"dva_lower": Lower bound violation of voltage angle difference. (batch_size, nbranch)</p>
</li>
<li>
<p>"dva_upper": Upper bound violation of voltage angle difference. (batch_size, nbranch)</p>
</li>
<li>
<p>"pf_lower": Lower bound violation of power flow. (batch_size, nbranch)</p>
</li>
<li>
<p>"pf_upper": Upper bound violation of power flow. (batch_size, nbranch)</p>
</li>
<li>
<p>"p_balance": Power balance violation. (batch_size, nbus)</p>
</li>
<li>
<p>"ohm": Ohm's law violation. (batch_size, nbranch)</p>
</li>
</ul></div>
</dd>
<dt id="ml4opf.DCViolation.dva_bound_residual"><code class="name flex">
<span>def <span class="ident">dva_bound_residual</span></span>(<span>self, dva: torch.Tensor, clamp: bool = False) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/dc/violation.py#L90-L104" class="git-link">Browse git</a></div>
<div class="desc"><p>Calculate the voltage angle difference bound residual.</p>
<p><span><span class="MathJax_Preview"> g_{\text{lower}} = \text{angmin} - \text{dva} </span><script type="math/tex; mode=display"> g_{\text{lower}} = \text{angmin} - \text{dva} </script></span>
<span><span class="MathJax_Preview"> g_{\text{upper}} = \text{dva} - \text{angmax} </span><script type="math/tex; mode=display"> g_{\text{upper}} = \text{dva} - \text{angmax} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>dva</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage angle differences per branch. (batch_size, nbranch)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Lower bound residual. (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Upper bound residual. (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.DCViolation.objective"><code class="name flex">
<span>def <span class="ident">objective</span></span>(<span>self, pg: torch.Tensor) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/dc/violation.py#L29-L42" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute DCOPF objective function.</p>
<p>Cost is assumed to be constant for the batch, matching the reference case.</p>
<p><span><span class="MathJax_Preview">
\text{objective} = \sum_i^n \text{cost}_{2,i} + \text{cost}_{1,i} \cdot \text{pg}_i
</span><script type="math/tex; mode=display">
\text{objective} = \sum_i^n \text{cost}_{2,i} + \text{cost}_{1,i} \cdot \text{pg}_i
</script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Power generation per generator. (batch_size, ngen)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Objective function value. (batch_size, 1)</dd>
</dl></div>
</dd>
<dt id="ml4opf.DCViolation.ohm_residual"><code class="name flex">
<span>def <span class="ident">ohm_residual</span></span>(<span>self, pf: torch.Tensor, dva: torch.Tensor, clamp: bool = False) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/dc/violation.py#L133-L148" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute Ohm's law violation.</p>
<p><span><span class="MathJax_Preview">
\text{g_ohm} = - b \cdot \text{dva} - \text{pf}
</span><script type="math/tex; mode=display">
\text{g_ohm} = - b \cdot \text{dva} - \text{pf}
</script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pf</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Power flow per branch. (batch_size, nbranch)</dd>
<dt><strong><code>dva</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage angle differences per branch. (batch_size, nbranch)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp to extract only violations. Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Ohm's law violation. (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.DCViolation.pf_bound_residual"><code class="name flex">
<span>def <span class="ident">pf_bound_residual</span></span>(<span>self, pf: torch.Tensor, clamp: bool = False) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/dc/violation.py#L58-L72" class="git-link">Browse git</a></div>
<div class="desc"><p>Calculate the power flow bound residual.</p>
<p><span><span class="MathJax_Preview"> g_{\text{lower}} = -\text{rate_a} - \text{pf} </span><script type="math/tex; mode=display"> g_{\text{lower}} = -\text{rate_a} - \text{pf} </script></span>
<span><span class="MathJax_Preview"> g_{\text{upper}} = \text{pf} - \text{rate_a} </span><script type="math/tex; mode=display"> g_{\text{upper}} = \text{pf} - \text{rate_a} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pf</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Power flow per branch. (batch_size, nbranch)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Lower bound residual. (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Upper bound residual. (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.DCViolation.pf_from_va"><code class="name flex">
<span>def <span class="ident">pf_from_va</span></span>(<span>self, va: torch.Tensor) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/dc/violation.py#L44-L56" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute power flow given voltage angles.</p>
<p><span><span class="MathJax_Preview"> \mathbf{p}_f = -\text{b} \cdot (\boldsymbol{\theta}_{f} - \boldsymbol{\theta}_{t}) </span><script type="math/tex; mode=display"> \mathbf{p}_f = -\text{b} \cdot (\boldsymbol{\theta}_{f} - \boldsymbol{\theta}_{t}) </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>va</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage angles per bus ( <span><span class="MathJax_Preview">\boldsymbol{\theta}</span><script type="math/tex">\boldsymbol{\theta}</script></span> ). (batch_size, nbus)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Power flow per branch ( <span><span class="MathJax_Preview">\mathbf{p}_f</span><script type="math/tex">\mathbf{p}_f</script></span> ). (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.DCViolation.pg_bound_residual"><code class="name flex">
<span>def <span class="ident">pg_bound_residual</span></span>(<span>self, pg: torch.Tensor, clamp: bool = False) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/dc/violation.py#L74-L88" class="git-link">Browse git</a></div>
<div class="desc"><p>Calculate the power generation bound residual.</p>
<p><span><span class="MathJax_Preview"> g_{\text{lower}} = \text{pmin} - \text{pg} </span><script type="math/tex; mode=display"> g_{\text{lower}} = \text{pmin} - \text{pg} </script></span>
<span><span class="MathJax_Preview"> g_{\text{upper}} = \text{pg} - \text{pmax} </span><script type="math/tex; mode=display"> g_{\text{upper}} = \text{pg} - \text{pmax} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power generation per generator. (batch_size, ngen)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Lower bound residual. (batch_size, ngen)</dd>
<dt><code>Tensor</code></dt>
<dd>Upper bound residual. (batch_size, ngen)</dd>
</dl></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="ml4opf.formulations.violation.OPFViolation" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation">OPFViolation</a></b></code>:
<ul class="hlist">
<li><code><a title="ml4opf.formulations.violation.OPFViolation.adjacency_matrix" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.adjacency_matrix">adjacency_matrix</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_from_incidence" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.branch_from_incidence">branch_from_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_from_to_bus" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.branch_from_to_bus">branch_from_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_incidence" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.branch_incidence">branch_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_to_incidence" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.branch_to_incidence">branch_to_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_to_to_bus" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.branch_to_to_bus">branch_to_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.forward" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.forward">forward</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.gen_to_bus" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.gen_to_bus">gen_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.generator_incidence" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.generator_incidence">generator_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.load_incidence" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.load_incidence">load_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.load_to_bus" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.load_to_bus">load_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.reduce_violation" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.reduce_violation">reduce_violation</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.reduce_violations" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.reduce_violations">reduce_violations</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.violation_shapes" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.violation_shapes">violation_shapes</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="ml4opf.EDModel"><code class="flex name class">
<span>class <span class="ident">EDModel</span></span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ed/model.py#L12-L65" class="git-link">Browse git</a></div>
<div class="desc"><p><code><a title="ml4opf.OPFModel" href="#ml4opf.OPFModel">OPFModel</a></code> for EconomicDispatch</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.model.OPFModel" href="formulations/model.html#ml4opf.formulations.model.OPFModel">OPFModel</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.ed.model.PerfectEDModel" href="formulations/ed/model.html#ml4opf.formulations.ed.model.PerfectEDModel">PerfectEDModel</a></li>
<li><a title="ml4opf.models.basic_nn.ed_basic_nn.EDBasicNeuralNet" href="models/basic_nn/ed_basic_nn.html#ml4opf.models.basic_nn.ed_basic_nn.EDBasicNeuralNet">EDBasicNeuralNet</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="ml4opf.EDModel.problem"><code class="name">var <span class="ident">problem</span> : <a title="ml4opf.formulations.ed.problem.EDProblem" href="formulations/ed/problem.html#ml4opf.formulations.ed.problem.EDProblem">EDProblem</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ml4opf.EDModel.violation"><code class="name">var <span class="ident">violation</span> : <a title="ml4opf.formulations.ed.violation.EDViolation" href="formulations/ed/violation.html#ml4opf.formulations.ed.violation.EDViolation">EDViolation</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.EDModel.evaluate_model"><code class="name flex">
<span>def <span class="ident">evaluate_model</span></span>(<span>self, reduction: str | None = None, inner_reduction: str | None = None) ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ed/model.py#L18-L65" class="git-link">Browse git</a></div>
<div class="desc"><p>Evaluate the model on the test data.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>reduction</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Reduction method for the metrics. Defaults to None. Must be one of "mean", "sum","max", "none".
If specified, each value in the returned dictionary will be a scalar. Otherwise, they are arrays of shape (n_test_samples,)</dd>
<dt><strong><code>inner_reduction</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Reduction method for turning metrics calculated per component to per sample. Defaults to None. Must be one of "mean", "sum","max", "none".</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict[str, Tensor]</code></dt>
<dd>
<p>Dictionary containing Tensor metrics of the model's performance.</p>
<p><code>pg_lower</code>: Generator lower bound violation.</p>
<p><code>pg_upper</code>: Generator upper bound violation.</p>
<p><code>pf_lower</code>: Branch power flow lower bound violation.</p>
<p><code>pf_upper</code>: Branch power flow upper bound violation.</p>
<p><code>p_balance</code>: Power balance violation.</p>
<p><code>pg_mae</code>: Mean absolute error of the real power generation.</p>
<p><code>obj_mape</code>: Mean absolute percent error of the objective value.</p>
</dd>
</dl></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="ml4opf.formulations.model.OPFModel" href="formulations/model.html#ml4opf.formulations.model.OPFModel">OPFModel</a></b></code>:
<ul class="hlist">
<li><code><a title="ml4opf.formulations.model.OPFModel.load_from_checkpoint" href="formulations/model.html#ml4opf.formulations.model.OPFModel.load_from_checkpoint">load_from_checkpoint</a></code></li>
<li><code><a title="ml4opf.formulations.model.OPFModel.predict" href="formulations/model.html#ml4opf.formulations.model.OPFModel.predict">predict</a></code></li>
<li><code><a title="ml4opf.formulations.model.OPFModel.save_checkpoint" href="formulations/model.html#ml4opf.formulations.model.OPFModel.save_checkpoint">save_checkpoint</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="ml4opf.EDProblem"><code class="flex name class">
<span>class <span class="ident">EDProblem</span></span>
<span>(</span><span>data_directory: str, ptdf_path: str, dataset_name: str = 'ED', **parse_kwargs)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ed/problem.py#L11-L66" class="git-link">Browse git</a></div>
<div class="desc"><p><code><a title="ml4opf.OPFProblem" href="#ml4opf.OPFProblem">OPFProblem</a></code> for EconomicDispatch</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.problem.OPFProblem" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem">OPFProblem</a></li>
<li>abc.ABC</li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="ml4opf.EDProblem.default_combos"><code class="name">prop <span class="ident">default_combos</span> : dict[str, list[str]]</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ed/problem.py#L48-L54" class="git-link">Browse git</a></div>
<div class="desc"><p>Default combos for EconomicDispatch. input: pd, target: pg, va</p></div>
</dd>
<dt id="ml4opf.EDProblem.default_order"><code class="name">prop <span class="ident">default_order</span> : list[str]</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ed/problem.py#L56-L59" class="git-link">Browse git</a></div>
<div class="desc"><p>Default order for EconomicDispatch. input, target</p></div>
</dd>
<dt id="ml4opf.EDProblem.feasibility_check"><code class="name">prop <span class="ident">feasibility_check</span> : dict[str, str]</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ed/problem.py#L39-L46" class="git-link">Browse git</a></div>
<div class="desc"><p>Default feasibility check for EconomicDispatch.</p></div>
</dd>
<dt id="ml4opf.EDProblem.violation"><code class="name">prop <span class="ident">violation</span> : <a title="ml4opf.formulations.ed.violation.EDViolation" href="formulations/ed/violation.html#ml4opf.formulations.ed.violation.EDViolation">EDViolation</a></code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ed/problem.py#L61-L66" class="git-link">Browse git</a></div>
<div class="desc"><p>OPFViolation object for EconomicDispatch constraint calculations.</p></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="ml4opf.formulations.problem.OPFProblem" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem">OPFProblem</a></b></code>:
<ul class="hlist">
<li><code><a title="ml4opf.formulations.problem.OPFProblem.make_dataset" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem.make_dataset">make_dataset</a></code></li>
<li><code><a title="ml4opf.formulations.problem.OPFProblem.parse" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem.parse">parse</a></code></li>
<li><code><a title="ml4opf.formulations.problem.OPFProblem.slice_batch" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem.slice_batch">slice_batch</a></code></li>
<li><code><a title="ml4opf.formulations.problem.OPFProblem.slice_tensor" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem.slice_tensor">slice_tensor</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="ml4opf.EDViolation"><code class="flex name class">
<span>class <span class="ident">EDViolation</span></span>
<span>(</span><span>data: dict, ptdf: torch.Tensor)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ed/violation.py#L13-L116" class="git-link">Browse git</a></div>
<div class="desc"><p><code><a title="ml4opf.OPFViolation" href="#ml4opf.OPFViolation">OPFViolation</a></code> for EconomicDispatch</p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.violation.OPFViolation" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation">OPFViolation</a></li>
<li>torch.nn.modules.module.Module</li>
<li>abc.ABC</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.EDViolation.balance_residual"><code class="name flex">
<span>def <span class="ident">balance_residual</span></span>(<span>self,<br>pd: torch.Tensor,<br>pg: torch.Tensor,<br>dpb_surplus: torch.Tensor | None = None,<br>dpb_shortage: torch.Tensor | None = None,<br>clamp: bool = False) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ed/violation.py#L59-L74" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute power balance residual.</p></div>
</dd>
<dt id="ml4opf.EDViolation.calc_violations"><code class="name flex">
<span>def <span class="ident">calc_violations</span></span>(<span>self,<br>pd: torch.Tensor,<br>pg: torch.Tensor,<br>reduction: str = 'mean',<br>clamp: bool = True) ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ed/violation.py#L87-L106" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute all EconomicDispatch violations.</p></div>
</dd>
<dt id="ml4opf.EDViolation.objective"><code class="name flex">
<span>def <span class="ident">objective</span></span>(<span>self, pd: torch.Tensor, pg: torch.Tensor) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ed/violation.py#L24-L41" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute ED objective function.</p></div>
</dd>
<dt id="ml4opf.EDViolation.pf_bound_residual"><code class="name flex">
<span>def <span class="ident">pf_bound_residual</span></span>(<span>self, pf: torch.Tensor, df: torch.Tensor | None = None, clamp: bool = False) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ed/violation.py#L47-L57" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute power flow bound residual.</p></div>
</dd>
<dt id="ml4opf.EDViolation.pf_from_pdpg"><code class="name flex">
<span>def <span class="ident">pf_from_pdpg</span></span>(<span>self, pd: torch.Tensor, pg: torch.Tensor, dense_incidence: bool = False) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ed/violation.py#L76-L85" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute power flow from power demand and power generation.</p></div>
</dd>
<dt id="ml4opf.EDViolation.pg_bound_residual"><code class="name flex">
<span>def <span class="ident">pg_bound_residual</span></span>(<span>self, pg: torch.Tensor, clamp: bool = False) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/ed/violation.py#L43-L45" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute power generation bound residual.</p></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="ml4opf.formulations.violation.OPFViolation" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation">OPFViolation</a></b></code>:
<ul class="hlist">
<li><code><a title="ml4opf.formulations.violation.OPFViolation.adjacency_matrix" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.adjacency_matrix">adjacency_matrix</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_from_incidence" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.branch_from_incidence">branch_from_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_from_to_bus" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.branch_from_to_bus">branch_from_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_incidence" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.branch_incidence">branch_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_to_incidence" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.branch_to_incidence">branch_to_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_to_to_bus" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.branch_to_to_bus">branch_to_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.forward" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.forward">forward</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.gen_to_bus" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.gen_to_bus">gen_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.generator_incidence" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.generator_incidence">generator_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.load_incidence" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.load_incidence">load_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.load_to_bus" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.load_to_bus">load_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.reduce_violation" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.reduce_violation">reduce_violation</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.reduce_violations" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.reduce_violations">reduce_violations</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.violation_shapes" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.violation_shapes">violation_shapes</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="ml4opf.HyperSimplexRepair"><code class="flex name class">
<span>class <span class="ident">HyperSimplexRepair</span></span>
<span>(</span><span>xmin: torch.Tensor | None = None,<br>xmax: torch.Tensor | None = None,<br>X: torch.Tensor | None = None)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/layers/hypersimplex_repair.py#L9-L79" class="git-link">Browse git</a></div>
<div class="desc"><p>Repair layer for the hyper-simplex constraint
∑x=X, x̲≤x≤x̅.</p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>torch.nn.modules.module.Module</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.HyperSimplexRepair.forward"><code class="name flex">
<span>def <span class="ident">forward</span></span>(<span>self,<br>x: torch.Tensor,<br>xmin: torch.Tensor | None = None,<br>xmax: torch.Tensor | None = None,<br>X: torch.Tensor | None = None) ‑> Callable[..., Any]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/layers/hypersimplex_repair.py#L52-L79" class="git-link">Browse git</a></div>
<div class="desc"><p>Project onto ∑x=X, x̲≤x≤x̅</p></div>
</dd>
</dl>
</dd>
<dt id="ml4opf.LDFLoss"><code class="flex name class">
<span>class <span class="ident">LDFLoss</span></span>
<span>(</span><span>v: <a title="ml4opf.formulations.violation.OPFViolation" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation">OPFViolation</a>,<br>step_size: float,<br>kickin: int,<br>update_freq: int,<br>divide_by_counter: bool = True,<br>exclude_keys: str | list[str] | None = None)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/loss_functions/ldf.py#L12-L154" class="git-link">Browse git</a></div>
<div class="desc"><p>LDFLoss implements the Lagrangian Dual Framework.</p>
<p><code>exclude_keys</code> is either None to use all violations, "all" to skip all violations, or a list of keys to skip specific violations.</p>
<p>Initialize LDFLoss module.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>torch.nn.modules.module.Module</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.LDFLoss.end_epoch"><code class="name flex">
<span>def <span class="ident">end_epoch</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/loss_functions/ldf.py#L75-L80" class="git-link">Browse git</a></div>
<div class="desc"><p>Call this method at the end of each epoch.</p></div>
</dd>
<dt id="ml4opf.LDFLoss.forward"><code class="name flex">
<span>def <span class="ident">forward</span></span>(<span>self,<br>base_loss: torch.Tensor,<br>exclude_keys: str | list[str] | None = None,<br>**calc_violation_inputs: torch.Tensor) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/loss_functions/ldf.py#L116-L154" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute the LDF Loss for a batch of samples.</p></div>
</dd>
<dt id="ml4opf.LDFLoss.init_mults"><code class="name flex">
<span>def <span class="ident">init_mults</span></span>(<span>self, shapes=None)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/loss_functions/ldf.py#L82-L94" class="git-link">Browse git</a></div>
<div class="desc"><p>Initialize λ and trackers to zeros.</p></div>
</dd>
<dt id="ml4opf.LDFLoss.reset_trackers"><code class="name flex">
<span>def <span class="ident">reset_trackers</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/loss_functions/ldf.py#L96-L101" class="git-link">Browse git</a></div>
<div class="desc"><p>Reset the violation trackers to zeros.</p></div>
</dd>
<dt id="ml4opf.LDFLoss.start_epoch"><code class="name flex">
<span>def <span class="ident">start_epoch</span></span>(<span>self, epoch) ‑> str | None</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/loss_functions/ldf.py#L50-L73" class="git-link">Browse git</a></div>
<div class="desc"><p>Call this method at the start of each epoch.</p></div>
</dd>
<dt id="ml4opf.LDFLoss.update"><code class="name flex">
<span>def <span class="ident">update</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/loss_functions/ldf.py#L103-L114" class="git-link">Browse git</a></div>
<div class="desc"><p>Update the lagrangian dual multipliers (λ)</p></div>
</dd>
</dl>
</dd>
<dt id="ml4opf.OPFModel"><code class="flex name class">
<span>class <span class="ident">OPFModel</span></span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/model.py#L23-L66" class="git-link">Browse git</a></div>
<div class="desc"><p>An abstract base class for ACOPF models.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.ac.model.ACModel" href="formulations/ac/model.html#ml4opf.formulations.ac.model.ACModel">ACModel</a></li>
<li><a title="ml4opf.formulations.dc.model.DCModel" href="formulations/dc/model.html#ml4opf.formulations.dc.model.DCModel">DCModel</a></li>
<li><a title="ml4opf.formulations.ed.model.EDModel" href="formulations/ed/model.html#ml4opf.formulations.ed.model.EDModel">EDModel</a></li>
<li><a title="ml4opf.formulations.soc.model.SOCModel" href="formulations/soc/model.html#ml4opf.formulations.soc.model.SOCModel">SOCModel</a></li>
<li><a title="ml4opf.models.basic_nn.basic_nn.BasicNeuralNet" href="models/basic_nn/basic_nn.html#ml4opf.models.basic_nn.basic_nn.BasicNeuralNet">BasicNeuralNet</a></li>
</ul>
<h3>Static methods</h3>
<dl>
<dt id="ml4opf.OPFModel.load_from_checkpoint"><code class="name flex">
<span>def <span class="ident">load_from_checkpoint</span></span>(<span>path_to_folder: str,<br>problem: <a title="ml4opf.formulations.problem.OPFProblem" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem">OPFProblem</a>)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/model.py#L34-L41" class="git-link">Browse git</a></div>
<div class="desc"><p>Load the model's checkpoint from a file.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>path</code></strong> :&ensp;<code>str</code></dt>
<dd>Path to load the checkpoint from.</dd>
</dl></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.OPFModel.evaluate_model"><code class="name flex">
<span>def <span class="ident">evaluate_model</span></span>(<span>self, reduction: str | None = None, inner_reduction: str | None = None) ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/model.py#L54-L66" class="git-link">Browse git</a></div>
<div class="desc"><p>Evaluate the model on the test data.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>reduction</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Reduction method for the metrics. Defaults to None. Must be one of "mean", "sum", "none".
If specified, each value in the returned dictionary will be a scalar. Otherwise, they are arrays of shape (n_test_samples,)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict[str, Tensor]</code></dt>
<dd>Dictionary containing Tensor metrics of the model's performance.</dd>
</dl></div>
</dd>
<dt id="ml4opf.OPFModel.predict"><code class="name flex">
<span>def <span class="ident">predict</span></span>(<span>self, *inputs: torch.Tensor) ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/model.py#L43-L52" class="git-link">Browse git</a></div>
<div class="desc"><p>Predict the solution for a given set of inputs.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>*inputs</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Input tensors to the model.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict[str, Tensor]</code></dt>
<dd>Dictionary containing the solution.</dd>
</dl></div>
</dd>
<dt id="ml4opf.OPFModel.save_checkpoint"><code class="name flex">
<span>def <span class="ident">save_checkpoint</span></span>(<span>self, path_to_folder: str)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/model.py#L26-L32" class="git-link">Browse git</a></div>
<div class="desc"><p>Save the model's checkpoint to a file.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>path</code></strong> :&ensp;<code>str</code></dt>
<dd>Path to save the checkpoint.</dd>
</dl></div>
</dd>
</dl>
</dd>
<dt id="ml4opf.OPFProblem"><code class="flex name class">
<span>class <span class="ident">OPFProblem</span></span>
<span>(</span><span>data_directory: str, dataset_name: str, **parse_kwargs)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/problem.py#L27-L243" class="git-link">Browse git</a></div>
<div class="desc"><h1 id="opf-problem">OPF Problem</h1>
<p>This class parses the JSON/HDF5 files on initialization, providing a standard interface for accessing OPF data.</p>
<p>OPFProblem also includes methods for creating input/target tensors from the HDF5 data by concatenating keys,
though more complex datasets (e.g., for graph neural networks) can be created by accessing <code>train_data</code> and <code>json_data</code> directly.</p>
<p>By default, initializing OPFProblem will parse the HDF5/JSON files, remove infeasible samples, and set aside 5000 samples for testing.
The test data can be accessed via <code>test_data</code> - <code>train_data</code> will only contain the training data. Models should split the training data into
training/validation sets themselves downstream.</p>
<p>Initialization Arguments:</p>
<ul>
<li>
<p><code>data_directory (str)</code>: Path to the folder containing the problem files</p>
</li>
<li>
<p><code>dataset_name (str)</code>: Name of the problem to use</p>
</li>
<li>
<p><code>primal (bool)</code>: Whether to parse the primal data (default: True)</p>
</li>
<li>
<p><code>dual (bool)</code>: Whether to parse the dual data (default: True)</p>
</li>
<li>
<p><code>train_set (bool)</code>: Whether to parse the training set (default: True)</p>
</li>
<li>
<p><code>test_set (bool)</code>: Whether to parse the test set (default: True)</p>
</li>
<li>
<p><code>convert_to_float32 (bool)</code>: Whether to convert the data to float32 (default: True)</p>
</li>
<li>
<p><code>sanity_check (bool)</code>: Whether to perform a sanity check on the parsed data (default: True)</p>
</li>
</ul>
<p>Attributes:</p>
<ul>
<li>
<p><code>path (Path)</code>: Path to the problem file folder</p>
</li>
<li>
<p><code>name (str)</code>: Name of the problem to use</p>
</li>
<li>
<p><code>train_data (dict)</code>: Dictionary of parsed HDF5 data. If <code>make_test_set</code> is True, this is only the training set.</p>
</li>
<li>
<p><code>test_data (dict)</code>: Dictionary of parsed HDF5 data for the test set. If <code>make_test_set</code> is False, this is None.</p>
</li>
<li>
<p><code>json_data (dict)</code>: Dictionary of parsed JSON data.</p>
</li>
<li>
<p><code>violation (<a title="ml4opf.OPFViolation" href="#ml4opf.OPFViolation">OPFViolation</a>)</code>: OPFViolation object for computing constraint violations for this problem.</p>
</li>
</ul>
<p>Methods:</p>
<ul>
<li>
<p><code>parse</code>: Parse the JSON and HDF5 files for the problem</p>
</li>
<li>
<p><code>make_dataset</code>: Create input/target tensors by combining keys from the h5 data. Returns the TensorDataset and slices for extracting the original components.</p>
</li>
<li>
<p><code>slice_batch</code>: Extract the original components from a batch of data given the slices.</p>
</li>
<li>
<p><code>slice_tensor</code>: Extract the original components from a tensor given the slices.</p>
</li>
</ul></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.ac.problem.ACProblem" href="formulations/ac/problem.html#ml4opf.formulations.ac.problem.ACProblem">ACProblem</a></li>
<li><a title="ml4opf.formulations.dc.problem.DCProblem" href="formulations/dc/problem.html#ml4opf.formulations.dc.problem.DCProblem">DCProblem</a></li>
<li><a title="ml4opf.formulations.ed.problem.EDProblem" href="formulations/ed/problem.html#ml4opf.formulations.ed.problem.EDProblem">EDProblem</a></li>
<li><a title="ml4opf.formulations.soc.problem.SOCProblem" href="formulations/soc/problem.html#ml4opf.formulations.soc.problem.SOCProblem">SOCProblem</a></li>
</ul>
<h3>Static methods</h3>
<dl>
<dt id="ml4opf.OPFProblem.slice_batch"><code class="name flex">
<span>def <span class="ident">slice_batch</span></span>(<span>batch: tuple[torch.Tensor, ...], slices: list[dict[str, slice]])</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/problem.py#L167-L183" class="git-link">Browse git</a></div>
<div class="desc"><p>Slice the batch tensors into the original tensors</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>batch</code></strong> :&ensp;<code>tuple[Tensor, &hellip;]</code></dt>
<dd>Batch of tensors from the TensorDataset</dd>
<dt><strong><code>slices</code></strong> :&ensp;<code>list[dict[str, slice]]</code></dt>
<dd>List of dictionaries of slices</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>tuple[dict[str, Tensor], &hellip;]</code></dt>
<dd>Sliced tensors</dd>
</dl></div>
</dd>
<dt id="ml4opf.OPFProblem.slice_tensor"><code class="name flex">
<span>def <span class="ident">slice_tensor</span></span>(<span>tensor: torch.Tensor, slices: dict[str, slice])</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/problem.py#L185-L196" class="git-link">Browse git</a></div>
<div class="desc"><p>Slice the tensor into the original tensors</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>tensor</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Tensor to slice</dd>
<dt><strong><code>slices</code></strong> :&ensp;<code>dict[str, slice]</code></dt>
<dd>Dictionary of slices</dd>
</dl>
<h2 id="returns">Returns</h2>
<p><code>dict[str, Tensor]</code>: Sliced tensors</p></div>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="ml4opf.OPFProblem.default_combos"><code class="name">prop <span class="ident">default_combos</span> : dict[str, list[str]]</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/problem.py#L208-L213" class="git-link">Browse git</a></div>
<div class="desc"><p>A dictionary where keys represent elements of the tuple
from the TensorDataset and values are keys of the train_data
dictionary which are concatenated.
Used by <code>make_dataset</code>.</p></div>
</dd>
<dt id="ml4opf.OPFProblem.default_order"><code class="name">prop <span class="ident">default_order</span> : list[str]</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/problem.py#L215-L218" class="git-link">Browse git</a></div>
<div class="desc"><p>The order of the keys in the default_combos dictionary.</p></div>
</dd>
<dt id="ml4opf.OPFProblem.feasibility_check"><code class="name">prop <span class="ident">feasibility_check</span> : dict[str, str]</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/problem.py#L198-L206" class="git-link">Browse git</a></div>
<div class="desc"><p>Dictionary of keys and values to check feasibility of the problem.</p>
<p>Each key is checked to have the corresponding value. If any of them
does not match, the sample is removed from the dataset in <code><a title="ml4opf.PGLearnParser" href="#ml4opf.PGLearnParser">PGLearnParser</a></code>.
See ACOPFProblem.feasibility_check for an example.</p></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.OPFProblem.make_dataset"><code class="name flex">
<span>def <span class="ident">make_dataset</span></span>(<span>self,<br>combos: dict[str, list[str]] | None = None,<br>order: list[str] | None = None,<br>data: dict[str, torch.Tensor] | None = None,<br>test_set: bool = False,<br>sanity_check: bool = True) ‑> tuple[dict[str, torch.Tensor], list[dict[str, slice]]]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/problem.py#L118-L165" class="git-link">Browse git</a></div>
<div class="desc"><p>Make a TensorDataset from self.train_data given the keys in combos and the order of the keys in order.</p></div>
</dd>
<dt id="ml4opf.OPFProblem.parse"><code class="name flex">
<span>def <span class="ident">parse</span></span>(<span>self,<br>primal: bool = True,<br>dual: bool = True,<br>train_set: bool = True,<br>test_set: bool = True,<br>convert_to_float32: bool = True,<br>sanity_check: bool = True)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/problem.py#L89-L116" class="git-link">Browse git</a></div>
<div class="desc"><p>Parse the JSON and HDF5 files for the problem</p></div>
</dd>
</dl>
</dd>
<dt id="ml4opf.OPFViolation"><code class="flex name class">
<span>class <span class="ident">OPFViolation</span></span>
<span>(</span><span>data: dict[str, torch.Tensor])</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L19-L410" class="git-link">Browse git</a></div>
<div class="desc"><p>The <code><a title="ml4opf.OPFViolation" href="#ml4opf.OPFViolation">OPFViolation</a></code> class is where all the problem expressions (objective, constraints, etc.) are defined.
The classes provide a convenient interface for when the only varying quantity in the formulation
per sample is the load demand <code>pd</code>. If other quantities vary, the user should use the functional
interface at <code><a title="ml4opf.functional" href="functional/index.html">ml4opf.functional</a></code>.</p>
<p>When <code>clamp</code> is true, the values of g(x) are clamped to be non-negative and the values of h(x) are absolute-valued.
Otherwise the raw values are returned.</p>
<p><code><a title="ml4opf.OPFViolation" href="#ml4opf.OPFViolation">OPFViolation</a></code> is a <code>torch.nn.Module</code>; all tensors used in computation are registered as non-persistent buffers.
To move the module to a different device, use <code>.to(device)</code> as you would with any other <code>nn.Module</code>.
Make sure that when you pass data to <code><a title="ml4opf.OPFViolation" href="#ml4opf.OPFViolation">OPFViolation</a></code>, it is on the same device as <code><a title="ml4opf.OPFViolation" href="#ml4opf.OPFViolation">OPFViolation</a></code>.</p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>torch.nn.modules.module.Module</li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.ac.violation.ACViolation" href="formulations/ac/violation.html#ml4opf.formulations.ac.violation.ACViolation">ACViolation</a></li>
<li><a title="ml4opf.formulations.dc.violation.DCViolation" href="formulations/dc/violation.html#ml4opf.formulations.dc.violation.DCViolation">DCViolation</a></li>
<li><a title="ml4opf.formulations.ed.violation.EDViolation" href="formulations/ed/violation.html#ml4opf.formulations.ed.violation.EDViolation">EDViolation</a></li>
<li><a title="ml4opf.formulations.soc.violation.SOCViolation" href="formulations/soc/violation.html#ml4opf.formulations.soc.violation.SOCViolation">SOCViolation</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="ml4opf.OPFViolation.SUPPORTED_REDUCTIONS"><code class="name">var <span class="ident">SUPPORTED_REDUCTIONS</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="ml4opf.OPFViolation.clamped_bound_residual"><code class="name flex">
<span>def <span class="ident">clamped_bound_residual</span></span>(<span>x: torch.Tensor, xmin: torch.Tensor, xmax: torch.Tensor, clamp: bool)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L105-L112" class="git-link">Browse git</a></div>
<div class="desc"></div>
</dd>
<dt id="ml4opf.OPFViolation.reduce_violation"><code class="name flex">
<span>def <span class="ident">reduce_violation</span></span>(<span>violation: torch.Tensor, reduction: str, dim: int = 1)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L88-L99" class="git-link">Browse git</a></div>
<div class="desc"><p>Apply mean/sum/max to a single tensor.</p></div>
</dd>
<dt id="ml4opf.OPFViolation.reduce_violations"><code class="name flex">
<span>def <span class="ident">reduce_violations</span></span>(<span>violations: dict[str, torch.Tensor], reduction: str, dim: int = 1)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L80-L86" class="git-link">Browse git</a></div>
<div class="desc"><p>Apply mean/sum/max to every value in a dictionary.</p></div>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="ml4opf.OPFViolation.adjacency_matrix"><code class="name">prop <span class="ident">adjacency_matrix</span> : torch.Tensor</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L220-L250" class="git-link">Browse git</a></div>
<div class="desc"><p>Sparse adjacency matrix.</p>
<p>Each row corresponds to a bus and each column corresponds to a bus.
The value is 1 if there is a branch between the buses, and 0 otherwise.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>fbus</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>From bus indices. (nbranch,)</dd>
<dt><strong><code>tbus</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>To bus indices. (nbranch,)</dd>
<dt><strong><code>n_bus</code></strong> :&ensp;<code>int</code></dt>
<dd>Number of buses.</dd>
<dt><strong><code>n_branch</code></strong> :&ensp;<code>int</code></dt>
<dd>Number of branches.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Sparse adjacency matrix. (nbus, nbus)</dd>
</dl></div>
</dd>
<dt id="ml4opf.OPFViolation.adjacency_matrix_dense"><code class="name">prop <span class="ident">adjacency_matrix_dense</span> : torch.Tensor</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L312-L322" class="git-link">Browse git</a></div>
<div class="desc"></div>
</dd>
<dt id="ml4opf.OPFViolation.branch_from_incidence"><code class="name">prop <span class="ident">branch_from_incidence</span> : torch.Tensor</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L136-L155" class="git-link">Browse git</a></div>
<div class="desc"><p>Sparse branch from incidence matrix.</p>
<p>Each row corresponds to a bus and each column corresponds to a branch.
The value is 1 if the branch is from the bus, and 0 otherwise.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Sparse branch from incidence matrix. (nbus, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.OPFViolation.branch_from_incidence_dense"><code class="name">prop <span class="ident">branch_from_incidence_dense</span> : torch.Tensor</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L264-L274" class="git-link">Browse git</a></div>
<div class="desc"></div>
</dd>
<dt id="ml4opf.OPFViolation.branch_incidence"><code class="name">prop <span class="ident">branch_incidence</span> : torch.Tensor</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L114-L134" class="git-link">Browse git</a></div>
<div class="desc"><p>Sparse branch incidence matrix.</p>
<p>Each row corresponds to a bus and each column corresponds to a branch.
The value is 1 if the branch is from the bus, -1 if the branch is to the bus, and 0 otherwise.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Sparse branch incidence matrix. (nbus, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.OPFViolation.branch_incidence_dense"><code class="name">prop <span class="ident">branch_incidence_dense</span> : torch.Tensor</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L252-L262" class="git-link">Browse git</a></div>
<div class="desc"></div>
</dd>
<dt id="ml4opf.OPFViolation.branch_to_incidence"><code class="name">prop <span class="ident">branch_to_incidence</span> : torch.Tensor</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L157-L176" class="git-link">Browse git</a></div>
<div class="desc"><p>Sparse branch to incidence matrix.</p>
<p>Each row corresponds to a bus and each column corresponds to a branch.
The value is 1 if the branch is to the bus, and 0 otherwise.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Sparse branch to incidence matrix. (nbus, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.OPFViolation.branch_to_incidence_dense"><code class="name">prop <span class="ident">branch_to_incidence_dense</span> : torch.Tensor</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L276-L286" class="git-link">Browse git</a></div>
<div class="desc"></div>
</dd>
<dt id="ml4opf.OPFViolation.generator_incidence"><code class="name">prop <span class="ident">generator_incidence</span> : torch.Tensor</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L178-L197" class="git-link">Browse git</a></div>
<div class="desc"><p>Sparse generator incidence matrix.</p>
<p>Each row corresponds to a bus and each column corresponds to a generator.
The value is 1 if the generator is at the bus, and 0 otherwise.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Sparse generator incidence matrix. (nbus, ngen)</dd>
</dl></div>
</dd>
<dt id="ml4opf.OPFViolation.generator_incidence_dense"><code class="name">prop <span class="ident">generator_incidence_dense</span> : torch.Tensor</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L288-L298" class="git-link">Browse git</a></div>
<div class="desc"></div>
</dd>
<dt id="ml4opf.OPFViolation.load_incidence"><code class="name">prop <span class="ident">load_incidence</span> : torch.Tensor</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L199-L218" class="git-link">Browse git</a></div>
<div class="desc"><p>Sparse load incidence matrix.</p>
<p>Each row corresponds to a bus and each column corresponds to a load.
The value is 1 if the load is at the bus, and 0 otherwise.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Sparse load incidence matrix. (nbus, nload)</dd>
</dl></div>
</dd>
<dt id="ml4opf.OPFViolation.load_incidence_dense"><code class="name">prop <span class="ident">load_incidence_dense</span> : torch.Tensor</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L300-L310" class="git-link">Browse git</a></div>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.OPFViolation.branch_from_to_bus"><code class="name flex">
<span>def <span class="ident">branch_from_to_bus</span></span>(<span>self, pf_or_qf: torch.Tensor, method: str = 'pad') ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L368-L388" class="git-link">Browse git</a></div>
<div class="desc"><p>Embed batched branch-wise values to batched bus-wise.</p>
<p>The default method "pad" sums over any flows on branches from the same bus.
The matrix methods "dense_matrix" and "matrix" use the incidence matrix.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pf_or_qf</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Branch-wise values. (batch, nbranch)</dd>
<dt><strong><code>method</code></strong> :&ensp;<code>str</code></dt>
<dd>Method to use. Supported: ['pad', 'dense_matrix', 'matrix']</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Bus-wise values. (batch, nbus)</dd>
</dl></div>
</dd>
<dt id="ml4opf.OPFViolation.branch_to_to_bus"><code class="name flex">
<span>def <span class="ident">branch_to_to_bus</span></span>(<span>self, pt_or_qt: torch.Tensor, method: str = 'pad') ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L390-L410" class="git-link">Browse git</a></div>
<div class="desc"><p>Embed batched branch-wise values to batched bus-wise.</p>
<p>The default method "pad" sums over any flows on branches to the same bus.
The matrix methods "dense_matrix" and "matrix" use the incidence matrix.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pt_or_qt</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Branch-wise values. (batch, nbranch)</dd>
<dt><strong><code>method</code></strong> :&ensp;<code>str</code></dt>
<dd>Method to use. Supported: ['pad', 'dense_matrix', 'matrix']</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Bus-wise values. (batch, nbus)</dd>
</dl></div>
</dd>
<dt id="ml4opf.OPFViolation.calc_violations"><code class="name flex">
<span>def <span class="ident">calc_violations</span></span>(<span>self, *args, reduction: str = 'mean', clamp: bool = True) ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L68-L70" class="git-link">Browse git</a></div>
<div class="desc"><p>Calculate the violations of the constraints. Returns a dictionary of tensors.</p></div>
</dd>
<dt id="ml4opf.OPFViolation.forward"><code class="name flex">
<span>def <span class="ident">forward</span></span>(<span>self, *args, **kwargs) ‑> Callable[..., Any]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L101-L103" class="git-link">Browse git</a></div>
<div class="desc"><p>Pass-through for <code><a title="ml4opf.OPFViolation.calc_violations" href="#ml4opf.OPFViolation.calc_violations">OPFViolation.calc_violations()</a></code></p></div>
</dd>
<dt id="ml4opf.OPFViolation.gen_to_bus"><code class="name flex">
<span>def <span class="ident">gen_to_bus</span></span>(<span>self, pg_or_qg: torch.Tensor, method: str = 'pad') ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L324-L344" class="git-link">Browse git</a></div>
<div class="desc"><p>Embed generator-wise values to bus-wise.</p>
<p>The default method "pad" sums over any generators at the same bus.
The matrix methods "dense_matrix" and "matrix" use the incidence matrix.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pg_or_qg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Generator-wise values. (batch, ngen)</dd>
<dt><strong><code>method</code></strong> :&ensp;<code>str</code></dt>
<dd>Method to use. Supported: ['pad', 'dense_matrix', 'matrix']</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Bus-wise values. (batch, nbus)</dd>
</dl></div>
</dd>
<dt id="ml4opf.OPFViolation.load_to_bus"><code class="name flex">
<span>def <span class="ident">load_to_bus</span></span>(<span>self, pd_or_qd: torch.Tensor, method: str = 'pad') ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L346-L366" class="git-link">Browse git</a></div>
<div class="desc"><p>Embed load-wise values to bus-wise.</p>
<p>The default method "pad" sums over any loads at the same bus.
The matrix methods "dense_matrix" and "matrix" use the incidence matrix.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pd_or_qd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Load-wise values. (batch, ngen)</dd>
<dt><strong><code>method</code></strong> :&ensp;<code>str</code></dt>
<dd>Method to use. Supported: ['pad', 'dense_matrix', 'matrix']</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Bus-wise values. (batch, nbus)</dd>
</dl></div>
</dd>
<dt id="ml4opf.OPFViolation.objective"><code class="name flex">
<span>def <span class="ident">objective</span></span>(<span>self, *args) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L76-L78" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute the objective value for a batch of samples.</p></div>
</dd>
<dt id="ml4opf.OPFViolation.violation_shapes"><code class="name flex">
<span>def <span class="ident">violation_shapes</span></span>(<span>self) ‑> dict[str, int]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/violation.py#L72-L74" class="git-link">Browse git</a></div>
<div class="desc"><p>Return the shapes of the violations returned by <code><a title="ml4opf.OPFViolation.calc_violations" href="#ml4opf.OPFViolation.calc_violations">OPFViolation.calc_violations()</a></code>.</p></div>
</dd>
</dl>
</dd>
<dt id="ml4opf.ObjectiveLoss"><code class="flex name class">
<span>class <span class="ident">ObjectiveLoss</span></span>
<span>(</span><span>v: <a title="ml4opf.formulations.violation.OPFViolation" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation">OPFViolation</a>,<br>reduction: str | None = 'mean')</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/loss_functions/objective.py#L10-L50" class="git-link">Browse git</a></div>
<div class="desc"><p>ObjectiveLoss is the original objective of the OPF.</p>
<p>It takes as input the same arguments as the corresponding formulation's
<code>objective</code> method, and returns the objective value.</p>
<p>Initialize ObjectiveLoss module.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>v</code></strong> :&ensp;<code><a title="ml4opf.OPFViolation" href="#ml4opf.OPFViolation">OPFViolation</a></code></dt>
<dd>OPFViolation module.</dd>
<dt><strong><code>reduction</code></strong> :&ensp;<code>Optional[str]</code></dt>
<dd>Reduction operation. Default: "mean".</dd>
</dl></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li>torch.nn.modules.module.Module</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="ml4opf.ObjectiveLoss.SUPPORTED_REDUCTIONS"><code class="name">var <span class="ident">SUPPORTED_REDUCTIONS</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.ObjectiveLoss.forward"><code class="name flex">
<span>def <span class="ident">forward</span></span>(<span>self, *objective_args, **objective_kwargs) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/loss_functions/objective.py#L37-L50" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute the objective value for a batch of samples.</p></div>
</dd>
</dl>
</dd>
<dt id="ml4opf.PGLearnParser"><code class="flex name class">
<span>class <span class="ident">PGLearnParser</span></span>
<span>(</span><span>data_path: str | pathlib.Path)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/parsers/pglearn.py#L22-L314" class="git-link">Browse git</a></div>
<div class="desc"><p>Parser for PGLearn dataset.</p>
<p>Initialize the parser by validating and setting the path.</p></div>
<h3>Class variables</h3>
<dl>
<dt id="ml4opf.PGLearnParser.padval"><code class="name">var <span class="ident">padval</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Static methods</h3>
<dl>
<dt id="ml4opf.PGLearnParser.convert_to_float32"><code class="name flex">
<span>def <span class="ident">convert_to_float32</span></span>(<span>dat: dict[str, torch.Tensor | numpy.ndarray | numpy.str_])</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/parsers/pglearn.py#L150-L156" class="git-link">Browse git</a></div>
<div class="desc"><p>Convert all float64 data to float32 in-place.</p></div>
</dd>
<dt id="ml4opf.PGLearnParser.make_tree"><code class="name flex">
<span>def <span class="ident">make_tree</span></span>(<span>dat: dict[str, torch.Tensor | numpy.ndarray | numpy.str_],<br>delimiter: str = '/')</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/parsers/pglearn.py#L158-L186" class="git-link">Browse git</a></div>
<div class="desc"><p>Convert a flat dictionary to a tree.
Note that the keys of <code>dat</code> must have a tree structure where data is only at the leaves.
Assumes keys are delimited by "/", i.e. "solution/primal/pg".</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>dat</code></strong> :&ensp;<code>dict</code></dt>
<dd>Flat dictionary of data.</dd>
<dt><strong><code>delimiter</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Delimiter to use for splitting keys. Defaults to "/".</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict</code></dt>
<dd>Tree dictionary of data from <code>dat</code>.</dd>
</dl></div>
</dd>
<dt id="ml4opf.PGLearnParser.pad_to_dense"><code class="name flex">
<span>def <span class="ident">pad_to_dense</span></span>(<span>array, padval, dtype=builtins.int)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/parsers/pglearn.py#L285-L314" class="git-link">Browse git</a></div>
<div class="desc"><p>from <a href="https://codereview.stackexchange.com/questions/222623/pad-a-ragged-multidimensional-array-to-rectangular-shape">https://codereview.stackexchange.com/questions/222623/pad-a-ragged-multidimensional-array-to-rectangular-shape</a></p></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.PGLearnParser.open_json"><code class="name flex">
<span>def <span class="ident">open_json</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/parsers/pglearn.py#L192-L202" class="git-link">Browse git</a></div>
<div class="desc"><p>Open the JSON file, supporting gzip and bz2 compression based on the file suffix.</p></div>
</dd>
<dt id="ml4opf.PGLearnParser.parse_h5"><code class="name flex">
<span>def <span class="ident">parse_h5</span></span>(<span>self,<br>dataset_name: str,<br>split: str = 'train',<br>primal: bool = True,<br>dual: bool = False,<br>convert_to_float32: bool = True) ‑> dict[str, torch.Tensor | numpy.ndarray | numpy.str_] | tuple[dict[str, torch.Tensor | numpy.ndarray | numpy.str_], dict[str, torch.Tensor | numpy.ndarray | numpy.str_]]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/parsers/pglearn.py#L52-L148" class="git-link">Browse git</a></div>
<div class="desc"><p>Parse the HDF5 file.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>dataset_name</code></strong> :&ensp;<code>str</code></dt>
<dd>The name of the dataset. Typically the formulation ("ACOPF", "DCOPF", etc.).</dd>
<dt><strong><code>split</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The split to return. Defaults to "train".</dd>
<dt><strong><code>primal</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>If True, parse the primal file. Defaults to True.</dd>
<dt><strong><code>dual</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>If True, parse the dual file. Defaults to False.</dd>
<dt><strong><code>convert_to_float32</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>If True, convert all float64 data to torch.float32. Defaults to True.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict</code></dt>
<dd>Flattened dictionary of HDF5 data with PyTorch tensors for numerical data and NumPy arrays for string/object data.</dd>
</dl>
<p>If <code>make_test_set</code> is True, then this function will return a tuple of two dictionaries. The first dictionary is the
training set and the second dictionary is the test set. The test set is a random 10% sample of the training set.</p>
<p>This parser will return a single-level dictionary where the keys are in the form
of <code>solution/primal/pg</code> where <code>solution</code> is the group, <code>primal</code> is the subgroup,
and <code>pg</code> is the dataset from the HDF5 file. The values are PyTorch tensors. This
parser uses <code>h5py.File.visititems</code> to iterate over the HDF5 file quickly.</p></div>
</dd>
<dt id="ml4opf.PGLearnParser.parse_json"><code class="name flex">
<span>def <span class="ident">parse_json</span></span>(<span>self, model_type: str | Sequence[str] = None)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/parsers/pglearn.py#L204-L276" class="git-link">Browse git</a></div>
<div class="desc"><p>Parse the JSON file from PGLearn.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>model_type</code></strong> :&ensp;<code>Union[str, Sequence[str]]</code></dt>
<dd>The reference solutions to save. Default: [] (no reference solutions saved.)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict</code></dt>
<dd>Dictionary containing the parsed data.</dd>
</dl>
<p>In the JSON file, the data is stored by each individual component.
So to get generator 1's upper bound on active generation, you'd look at:
raw_json['data']['gen']['1']['pmax'] and get a float.</p>
<p>In the parsed version, we aggregate each of the components attributes into torch.Tensor arrays.
So to get generator 1's upper bound on active generation, you'd look at:
dat['gen']['pmax'][0] and get a float.
Note that the index is 0-based and an integer, not 1-based and a string.</p>
<p>To access the reference solution, pass a model_type (or multiple) and then access dat["ref_solutions"][model_type].</p></div>
</dd>
<dt id="ml4opf.PGLearnParser.validate_path"><code class="name flex">
<span>def <span class="ident">validate_path</span></span>(<span>self, path: str | pathlib.Path) ‑> pathlib.Path</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/parsers/pglearn.py#L32-L46" class="git-link">Browse git</a></div>
<div class="desc"><p>Validate the path to the HDF5 file.</p></div>
</dd>
</dl>
</dd>
<dt id="ml4opf.SOCModel"><code class="flex name class">
<span>class <span class="ident">SOCModel</span></span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/soc/model.py#L10-L95" class="git-link">Browse git</a></div>
<div class="desc"><p><code><a title="ml4opf.OPFModel" href="#ml4opf.OPFModel">OPFModel</a></code> for SOCOPF</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.model.OPFModel" href="formulations/model.html#ml4opf.formulations.model.OPFModel">OPFModel</a></li>
<li>abc.ABC</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.soc.model.PerfectSOCModel" href="formulations/soc/model.html#ml4opf.formulations.soc.model.PerfectSOCModel">PerfectSOCModel</a></li>
<li><a title="ml4opf.models.basic_nn.socopf_basic_nn.SOCBasicNeuralNet" href="models/basic_nn/socopf_basic_nn.html#ml4opf.models.basic_nn.socopf_basic_nn.SOCBasicNeuralNet">SOCBasicNeuralNet</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="ml4opf.SOCModel.problem"><code class="name">var <span class="ident">problem</span> : <a title="ml4opf.formulations.soc.problem.SOCProblem" href="formulations/soc/problem.html#ml4opf.formulations.soc.problem.SOCProblem">SOCProblem</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ml4opf.SOCModel.violation"><code class="name">var <span class="ident">violation</span> : <a title="ml4opf.formulations.soc.violation.SOCViolation" href="formulations/soc/violation.html#ml4opf.formulations.soc.violation.SOCViolation">SOCViolation</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.SOCModel.predict"><code class="name flex">
<span>def <span class="ident">predict</span></span>(<span>self, pd: torch.Tensor, qd: torch.Tensor) ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/soc/model.py#L16-L36" class="git-link">Browse git</a></div>
<div class="desc"><p>Predict the SOCOPF primal solution for a given set of loads.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power demand per load.</dd>
<dt><strong><code>qd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power demand per load.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict[str, Tensor]</code></dt>
<dd>
<p>Dictionary containing the predicted primal solution.</p>
<p><code>pg</code>: Active power generation per generator or per bus.</p>
<p><code>qg</code>: Reactive power generation per generator or per bus.</p>
<p><code>w</code>: Squared voltage magnitude per bus.</p>
<p><code>wr</code>: Real part of the voltage phasor.</p>
<p><code>wi</code>: Imaginary part of the voltage phasor.</p>
</dd>
</dl></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="ml4opf.formulations.model.OPFModel" href="formulations/model.html#ml4opf.formulations.model.OPFModel">OPFModel</a></b></code>:
<ul class="hlist">
<li><code><a title="ml4opf.formulations.model.OPFModel.evaluate_model" href="formulations/model.html#ml4opf.formulations.model.OPFModel.evaluate_model">evaluate_model</a></code></li>
<li><code><a title="ml4opf.formulations.model.OPFModel.load_from_checkpoint" href="formulations/model.html#ml4opf.formulations.model.OPFModel.load_from_checkpoint">load_from_checkpoint</a></code></li>
<li><code><a title="ml4opf.formulations.model.OPFModel.save_checkpoint" href="formulations/model.html#ml4opf.formulations.model.OPFModel.save_checkpoint">save_checkpoint</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="ml4opf.SOCProblem"><code class="flex name class">
<span>class <span class="ident">SOCProblem</span></span>
<span>(</span><span>data_directory: str, dataset_name: str = 'SOCOPF', **parse_kwargs)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/soc/problem.py#L7-L82" class="git-link">Browse git</a></div>
<div class="desc"><p><code><a title="ml4opf.OPFProblem" href="#ml4opf.OPFProblem">OPFProblem</a></code> for SOCOPF</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.problem.OPFProblem" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem">OPFProblem</a></li>
<li>abc.ABC</li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="ml4opf.SOCProblem.default_combos"><code class="name">prop <span class="ident">default_combos</span> : dict[str, list[str]]</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/soc/problem.py#L59-L70" class="git-link">Browse git</a></div>
<div class="desc"><p>Default combos for SOCOPF:</p>
<ul>
<li>
<p>input: pd, qd</p>
</li>
<li>
<p>target: pg, qg, w, wr, wi</p>
</li>
</ul></div>
</dd>
<dt id="ml4opf.SOCProblem.default_order"><code class="name">prop <span class="ident">default_order</span> : list[str]</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/soc/problem.py#L72-L75" class="git-link">Browse git</a></div>
<div class="desc"><p>Default order for SOCOPF: input, target</p></div>
</dd>
<dt id="ml4opf.SOCProblem.feasibility_check"><code class="name">prop <span class="ident">feasibility_check</span> : dict[str, str]</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/soc/problem.py#L43-L57" class="git-link">Browse git</a></div>
<div class="desc"><p>Default feasibility check for SOCOPF:</p>
<ul>
<li>
<p>termination_status: "LOCALLY_SOLVED"</p>
</li>
<li>
<p>primal_status: "FEASIBLE_POINT"</p>
</li>
<li>
<p>dual_status: "FEASIBLE_POINT"</p>
</li>
</ul></div>
</dd>
<dt id="ml4opf.SOCProblem.violation"><code class="name">prop <span class="ident">violation</span> : <a title="ml4opf.formulations.soc.violation.SOCViolation" href="formulations/soc/violation.html#ml4opf.formulations.soc.violation.SOCViolation">SOCViolation</a></code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/soc/problem.py#L77-L82" class="git-link">Browse git</a></div>
<div class="desc"><p><code><a title="ml4opf.SOCViolation" href="#ml4opf.SOCViolation">SOCViolation</a></code> object, created upon first access.</p></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="ml4opf.formulations.problem.OPFProblem" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem">OPFProblem</a></b></code>:
<ul class="hlist">
<li><code><a title="ml4opf.formulations.problem.OPFProblem.make_dataset" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem.make_dataset">make_dataset</a></code></li>
<li><code><a title="ml4opf.formulations.problem.OPFProblem.parse" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem.parse">parse</a></code></li>
<li><code><a title="ml4opf.formulations.problem.OPFProblem.slice_batch" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem.slice_batch">slice_batch</a></code></li>
<li><code><a title="ml4opf.formulations.problem.OPFProblem.slice_tensor" href="formulations/problem.html#ml4opf.formulations.problem.OPFProblem.slice_tensor">slice_tensor</a></code></li>
</ul>
</li>
</ul>
</dd>
<dt id="ml4opf.SOCViolation"><code class="flex name class">
<span>class <span class="ident">SOCViolation</span></span>
<span>(</span><span>data: dict)</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/soc/violation.py#L12-L348" class="git-link">Browse git</a></div>
<div class="desc"><p><code><a title="ml4opf.OPFViolation" href="#ml4opf.OPFViolation">OPFViolation</a></code> for SOCOPF</p>
<p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p></div>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ml4opf.formulations.violation.OPFViolation" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation">OPFViolation</a></li>
<li>torch.nn.modules.module.Module</li>
<li>abc.ABC</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="ml4opf.SOCViolation.angle_difference_residual"><code class="name flex">
<span>def <span class="ident">angle_difference_residual</span></span>(<span>self, wr: torch.Tensor, wi: torch.Tensor, clamp: bool = False) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/soc/violation.py#L70-L72" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute the angle difference bound residual.</p></div>
</dd>
<dt id="ml4opf.SOCViolation.balance_residual"><code class="name flex">
<span>def <span class="ident">balance_residual</span></span>(<span>self,<br>pd: torch.Tensor,<br>qd: torch.Tensor,<br>pg: torch.Tensor,<br>qg: torch.Tensor,<br>w: torch.Tensor,<br>pf: torch.Tensor,<br>pt: torch.Tensor,<br>qf: torch.Tensor,<br>qt: torch.Tensor,<br>clamp: bool = False,<br>embed_method: str = 'pad') ‑> tuple[torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/soc/violation.py#L159-L215" class="git-link">Browse git</a></div>
<div class="desc"><p>Calculate the power balance residual.</p>
<p>Component-wise tensors are first embedded to the bus level using <code>embed_method</code>.</p>
<p>The shunt parameters <span><span class="MathJax_Preview"> g_s, b_s </span><script type="math/tex"> g_s, b_s </script></span> are assumed to be constant, matching the reference case.</p>
<p><span><span class="MathJax_Preview"> \text{p_viol} = \text{pg_bus} - \text{pd_bus} - \text{pt_bus} - \text{pf_bus} - \text{gs_bus} \times \text{vm}^2 </span><script type="math/tex; mode=display"> \text{p_viol} = \text{pg_bus} - \text{pd_bus} - \text{pt_bus} - \text{pf_bus} - \text{gs_bus} \times \text{vm}^2 </script></span>
<span><span class="MathJax_Preview"> \text{q_viol} = \text{qg_bus} - \text{qd_bus} - \text{qt_bus} - \text{qf_bus} + \text{bs_bus} \times \text{vm}^2 </span><script type="math/tex; mode=display"> \text{q_viol} = \text{qg_bus} - \text{qd_bus} - \text{qt_bus} - \text{qf_bus} + \text{bs_bus} \times \text{vm}^2 </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power demand per bus. (batch_size, nbus)</dd>
<dt><strong><code>qd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power demand per bus. (batch_size, nbus)</dd>
<dt><strong><code>pg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power generation per generator. (batch_size, ngen)</dd>
<dt><strong><code>qg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power generation per generator. (batch_size, ngen)</dd>
<dt><strong><code>vm</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage magnitude per bus. (batch_size, nbus)</dd>
<dt><strong><code>pf</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power flow from bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>pt</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power flow to bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>qf</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power flow from bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>qt</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power flow to bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Apply an absolute value to the residual. Defaults to False.</dd>
<dt><strong><code>embed_method</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Embedding method for bus-level components. Defaults to 'pad'. Must be one of 'pad', 'dense_matrix', or 'matrix. See <code>IncidenceMixin.*_to_bus</code>.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Power balance residual for active power. (batch_size, nbus)</dd>
<dt><code>Tensor</code></dt>
<dd>Power balance residual for reactive power. (batch_size, nbus)</dd>
</dl></div>
</dd>
<dt id="ml4opf.SOCViolation.calc_violations"><code class="name flex">
<span>def <span class="ident">calc_violations</span></span>(<span>self,<br>pd: torch.Tensor,<br>qd: torch.Tensor,<br>pg: torch.Tensor,<br>qg: torch.Tensor,<br>w: torch.Tensor,<br>wr: torch.Tensor,<br>wi: torch.Tensor,<br>flows: tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor] | None = None,<br>reduction: str | None = 'mean',<br>clamp: bool = True) ‑> dict[str, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/soc/violation.py#L234-L326" class="git-link">Browse git</a></div>
<div class="desc"><p>Calculate the violation of all the constraints.</p>
<p>The reduction is applied across the component dimension - e.g., 'mean' will do violation.mean(dim=1) where each violation is (batch, components)</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Real power demand. (batch, loads)</dd>
<dt><strong><code>qd</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power demand. (batch, loads)</dd>
<dt><strong><code>pg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Real power generation. (batch, gens)</dd>
<dt><strong><code>qg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power generation. (batch, gens)</dd>
<dt><strong><code>vm</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Voltage magnitude. (batch, buses)</dd>
<dt><strong><code>va</code></strong> :&ensp;<code>Tensor</code>, optional</dt>
<dd>Voltage angle. (batch, buses)</dd>
<dt><strong><code>dva</code></strong> :&ensp;<code>Tensor</code>, optional</dt>
<dd>Voltage angle difference. (batch, branches)</dd>
<dt><strong><code>flows</code></strong> :&ensp;<code>tuple[Tensor, Tensor, Tensor, Tensor]</code>, optional</dt>
<dd>Power flows. (pf, pt, qf, qt)</dd>
<dt><strong><code>reduction</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>Reduction method. Defaults to 'mean'. Must be one of 'mean', 'sum', 'none'.</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to True.</dd>
</dl>
<h2 id="returns">Returns</h2>
<ul>
<li>dict[str, Tensor]: Dictionary of violations.</li>
</ul>
<p><code>vm_lower</code>: Voltage magnitude lower bound violation.</p>
<p><code>vm_upper</code>: Voltage magnitude upper bound violation.</p>
<p><code>pg_lower</code>: Real power generation lower bound violation.</p>
<p><code>pg_upper</code>: Real power generation upper bound violation.</p>
<p><code>qg_lower</code>: Reactive power generation lower bound violation.</p>
<p><code>qg_upper</code>: Reactive power generation upper bound violation.</p>
<p><code>thrm_1</code>: Thermal limit from violation.</p>
<p><code>thrm_2</code>: Thermal limit to violation.</p>
<p><code>p_balance</code>: Real power balance violation.</p>
<p><code>q_balance</code>: Reactive power balance violation.</p>
<p><code>dva_lower</code>: Voltage angle difference lower bound violation.</p>
<p><code>dva_upper</code>: Voltage angle difference upper bound violation.</p></div>
</dd>
<dt id="ml4opf.SOCViolation.flows_from_voltage"><code class="name flex">
<span>def <span class="ident">flows_from_voltage</span></span>(<span>self, w: torch.Tensor, wr: torch.Tensor, wi: torch.Tensor) ‑> tuple[torch.Tensor, torch.Tensor, torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/soc/violation.py#L44-L68" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute the power flows.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Real power flow per branch ( <span><span class="MathJax_Preview">\mathbf{p}_f</span><script type="math/tex">\mathbf{p}_f</script></span> ). (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Real power flow per branch ( <span><span class="MathJax_Preview">\mathbf{p}_t</span><script type="math/tex">\mathbf{p}_t</script></span> ). (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Reactive power flow per branch ( <span><span class="MathJax_Preview">\mathbf{q}_f</span><script type="math/tex">\mathbf{q}_f</script></span> ). (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Reactive power flow per branch ( <span><span class="MathJax_Preview">\mathbf{q}_t</span><script type="math/tex">\mathbf{q}_t</script></span> ). (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.SOCViolation.jabr_residual"><code class="name flex">
<span>def <span class="ident">jabr_residual</span></span>(<span>self, w: torch.Tensor, wr: torch.Tensor, wi: torch.Tensor, clamp: bool = False) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/soc/violation.py#L217-L232" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute the Jabr constraint residual.</p>
<p><span><span class="MathJax_Preview"> g_{\text{jabr}} = \text{wr}^2 + \text{wi}^2 - \text{w}_{fr} * \text{w}_{to} </span><script type="math/tex; mode=display"> g_{\text{jabr}} = \text{wr}^2 + \text{wi}^2 - \text{w}_{fr} * \text{w}_{to} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>w</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Squared voltage magnitude per bus. (batch_size, nbus)</dd>
<dt><strong><code>wr</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Real part of the voltage phasor. (batch_size, nbus)</dd>
<dt><strong><code>wi</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Imaginary part of the voltage phasor. (batch_size, nbus)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Jabr constraint residual. (batch_size, nbus)</dd>
</dl></div>
</dd>
<dt id="ml4opf.SOCViolation.objective"><code class="name flex">
<span>def <span class="ident">objective</span></span>(<span>self, pg: torch.Tensor) ‑> torch.Tensor</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/soc/violation.py#L33-L42" class="git-link">Browse git</a></div>
<div class="desc"><p>Compute the objective function given the active power generation per generator.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power generation per generator. (batch_size, ngen)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Objective function value. (batch_size)</dd>
</dl></div>
</dd>
<dt id="ml4opf.SOCViolation.pg_bound_residual"><code class="name flex">
<span>def <span class="ident">pg_bound_residual</span></span>(<span>self, pg: torch.Tensor, clamp: bool = False) ‑> tuple[torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/soc/violation.py#L101-L115" class="git-link">Browse git</a></div>
<div class="desc"><p>Calculate the active power generation bound residual.</p>
<p><span><span class="MathJax_Preview"> g_{\text{lower}} = \text{pmin} - \text{pg} </span><script type="math/tex; mode=display"> g_{\text{lower}} = \text{pmin} - \text{pg} </script></span>
<span><span class="MathJax_Preview"> g_{\text{upper}} = \text{pg} - \text{pmax} </span><script type="math/tex; mode=display"> g_{\text{upper}} = \text{pg} - \text{pmax} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power generation per generator. (batch_size, ngen)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Lower bound residual. (batch_size, ngen)</dd>
<dt><code>Tensor</code></dt>
<dd>Upper bound residual. (batch_size, ngen)</dd>
</dl></div>
</dd>
<dt id="ml4opf.SOCViolation.qg_bound_residual"><code class="name flex">
<span>def <span class="ident">qg_bound_residual</span></span>(<span>self, qg: torch.Tensor, clamp: bool = False) ‑> tuple[torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/soc/violation.py#L117-L131" class="git-link">Browse git</a></div>
<div class="desc"><p>Calculate the reactive power generation bound residual.</p>
<p><span><span class="MathJax_Preview"> g_{\text{lower}} = \text{qmin} - \text{qg} </span><script type="math/tex; mode=display"> g_{\text{lower}} = \text{qmin} - \text{qg} </script></span>
<span><span class="MathJax_Preview"> g_{\text{upper}} = \text{qg} - \text{qmax} </span><script type="math/tex; mode=display"> g_{\text{upper}} = \text{qg} - \text{qmax} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>qg</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power generation per generator. (batch_size, ngen)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Lower bound residual. (batch_size, ngen)</dd>
<dt><code>Tensor</code></dt>
<dd>Upper bound residual. (batch_size, ngen)</dd>
</dl></div>
</dd>
<dt id="ml4opf.SOCViolation.thermal_residual"><code class="name flex">
<span>def <span class="ident">thermal_residual</span></span>(<span>self,<br>pf: torch.Tensor,<br>pt: torch.Tensor,<br>qf: torch.Tensor,<br>qt: torch.Tensor,<br>clamp: bool = False) ‑> tuple[torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/soc/violation.py#L133-L157" class="git-link">Browse git</a></div>
<div class="desc"><p>Calculate the thermal limit residual.</p>
<p><span><span class="MathJax_Preview"> g_{\text{thrm}_1} = \text{pf}^2 + \text{qf}^2 - \text{s1max} </span><script type="math/tex; mode=display"> g_{\text{thrm}_1} = \text{pf}^2 + \text{qf}^2 - \text{s1max} </script></span>
<span><span class="MathJax_Preview"> g_{\text{thrm}_2} = \text{pt}^2 + \text{qt}^2 - \text{s2max} </span><script type="math/tex; mode=display"> g_{\text{thrm}_2} = \text{pt}^2 + \text{qt}^2 - \text{s2max} </script></span></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pf</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power flow from bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>pt</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Active power flow to bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>qf</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power flow from bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>qt</code></strong> :&ensp;<code>Tensor</code></dt>
<dd>Reactive power flow to bus per branch. (batch_size, nbranch)</dd>
<dt><strong><code>clamp</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Clamp the residual to be non-negative (extract violations). Defaults to False.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Thermal limit residual for from branch. (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Thermal limit residual for to branch. (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.SOCViolation.w_bound_residual"><code class="name flex">
<span>def <span class="ident">w_bound_residual</span></span>(<span>self, w: torch.Tensor, clamp: bool = False) ‑> tuple[torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/soc/violation.py#L74-L81" class="git-link">Browse git</a></div>
<div class="desc"><p>Calculate the bound residual of w.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Lower bound residual. (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Upper bound residual. (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.SOCViolation.wi_bound_residual"><code class="name flex">
<span>def <span class="ident">wi_bound_residual</span></span>(<span>self, wr: torch.Tensor, clamp: bool = False) ‑> tuple[torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/soc/violation.py#L92-L99" class="git-link">Browse git</a></div>
<div class="desc"><p>Calculate the bound residual of wi.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Lower bound residual. (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Upper bound residual. (batch_size, nbranch)</dd>
</dl></div>
</dd>
<dt id="ml4opf.SOCViolation.wr_bound_residual"><code class="name flex">
<span>def <span class="ident">wr_bound_residual</span></span>(<span>self, wr: torch.Tensor, clamp: bool = False) ‑> tuple[torch.Tensor, torch.Tensor]</span>
</code></dt>
<dd>
<div class="git-link-div"><a href="https://github.com/AI4OPT/ML4OPF/blob/8f8e6125352203d112bba4c89092347fd7629c56/ml4opf/formulations/soc/violation.py#L83-L90" class="git-link">Browse git</a></div>
<div class="desc"><p>Calculate the bound residual of wr.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Tensor</code></dt>
<dd>Lower bound residual. (batch_size, nbranch)</dd>
<dt><code>Tensor</code></dt>
<dd>Upper bound residual. (batch_size, nbranch)</dd>
</dl></div>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="ml4opf.formulations.violation.OPFViolation" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation">OPFViolation</a></b></code>:
<ul class="hlist">
<li><code><a title="ml4opf.formulations.violation.OPFViolation.adjacency_matrix" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.adjacency_matrix">adjacency_matrix</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_from_incidence" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.branch_from_incidence">branch_from_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_from_to_bus" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.branch_from_to_bus">branch_from_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_incidence" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.branch_incidence">branch_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_to_incidence" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.branch_to_incidence">branch_to_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.branch_to_to_bus" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.branch_to_to_bus">branch_to_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.forward" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.forward">forward</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.gen_to_bus" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.gen_to_bus">gen_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.generator_incidence" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.generator_incidence">generator_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.load_incidence" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.load_incidence">load_incidence</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.load_to_bus" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.load_to_bus">load_to_bus</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.reduce_violation" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.reduce_violation">reduce_violation</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.reduce_violations" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.reduce_violations">reduce_violations</a></code></li>
<li><code><a title="ml4opf.formulations.violation.OPFViolation.violation_shapes" href="formulations/violation.html#ml4opf.formulations.violation.OPFViolation.violation_shapes">violation_shapes</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul>
<li><a href="#ml4opf-machine-learning-for-opf">ML4OPF: Machine Learning for OPF</a></li>
<li><a href="#loading-data">Loading data</a></li>
<li><a href="#computing-residuals">Computing residuals</a></li>
<li><a href="#implementing-an-opfmodel">Implementing an OPFModel</a></li>
<li><a href="#using-repair-layers">Using repair layers</a></li>
</ul>
</div>
<ul id="index">
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="ml4opf.formulations" href="formulations/index.html">ml4opf.formulations</a></code></li>
<li><code><a title="ml4opf.functional" href="functional/index.html">ml4opf.functional</a></code></li>
<li><code><a title="ml4opf.layers" href="layers/index.html">ml4opf.layers</a></code></li>
<li><code><a title="ml4opf.loss_functions" href="loss_functions/index.html">ml4opf.loss_functions</a></code></li>
<li><code><a title="ml4opf.models" href="models/index.html">ml4opf.models</a></code></li>
<li><code><a title="ml4opf.parsers" href="parsers/index.html">ml4opf.parsers</a></code></li>
<li><code><a title="ml4opf.viz" href="viz/index.html">ml4opf.viz</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="ml4opf.ACModel" href="#ml4opf.ACModel">ACModel</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.ACModel.evaluate_model" href="#ml4opf.ACModel.evaluate_model">evaluate_model</a></code></li>
<li><code><a title="ml4opf.ACModel.predict" href="#ml4opf.ACModel.predict">predict</a></code></li>
<li><code><a title="ml4opf.ACModel.problem" href="#ml4opf.ACModel.problem">problem</a></code></li>
<li><code><a title="ml4opf.ACModel.violation" href="#ml4opf.ACModel.violation">violation</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.ACProblem" href="#ml4opf.ACProblem">ACProblem</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.ACProblem.default_combos" href="#ml4opf.ACProblem.default_combos">default_combos</a></code></li>
<li><code><a title="ml4opf.ACProblem.default_order" href="#ml4opf.ACProblem.default_order">default_order</a></code></li>
<li><code><a title="ml4opf.ACProblem.feasibility_check" href="#ml4opf.ACProblem.feasibility_check">feasibility_check</a></code></li>
<li><code><a title="ml4opf.ACProblem.violation" href="#ml4opf.ACProblem.violation">violation</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.ACViolation" href="#ml4opf.ACViolation">ACViolation</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.ACViolation.angle_difference" href="#ml4opf.ACViolation.angle_difference">angle_difference</a></code></li>
<li><code><a title="ml4opf.ACViolation.balance_residual" href="#ml4opf.ACViolation.balance_residual">balance_residual</a></code></li>
<li><code><a title="ml4opf.ACViolation.calc_violations" href="#ml4opf.ACViolation.calc_violations">calc_violations</a></code></li>
<li><code><a title="ml4opf.ACViolation.dva_bound_residual" href="#ml4opf.ACViolation.dva_bound_residual">dva_bound_residual</a></code></li>
<li><code><a title="ml4opf.ACViolation.flows_from_voltage" href="#ml4opf.ACViolation.flows_from_voltage">flows_from_voltage</a></code></li>
<li><code><a title="ml4opf.ACViolation.flows_from_voltage_bus" href="#ml4opf.ACViolation.flows_from_voltage_bus">flows_from_voltage_bus</a></code></li>
<li><code><a title="ml4opf.ACViolation.objective" href="#ml4opf.ACViolation.objective">objective</a></code></li>
<li><code><a title="ml4opf.ACViolation.pg_bound_residual" href="#ml4opf.ACViolation.pg_bound_residual">pg_bound_residual</a></code></li>
<li><code><a title="ml4opf.ACViolation.qg_bound_residual" href="#ml4opf.ACViolation.qg_bound_residual">qg_bound_residual</a></code></li>
<li><code><a title="ml4opf.ACViolation.thermal_residual" href="#ml4opf.ACViolation.thermal_residual">thermal_residual</a></code></li>
<li><code><a title="ml4opf.ACViolation.vm_bound_residual" href="#ml4opf.ACViolation.vm_bound_residual">vm_bound_residual</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.BoundRepair" href="#ml4opf.BoundRepair">BoundRepair</a></code></h4>
<ul class="two-column">
<li><code><a title="ml4opf.BoundRepair.SUPPORTED_METHODS" href="#ml4opf.BoundRepair.SUPPORTED_METHODS">SUPPORTED_METHODS</a></code></li>
<li><code><a title="ml4opf.BoundRepair.clamp" href="#ml4opf.BoundRepair.clamp">clamp</a></code></li>
<li><code><a title="ml4opf.BoundRepair.double_relu" href="#ml4opf.BoundRepair.double_relu">double_relu</a></code></li>
<li><code><a title="ml4opf.BoundRepair.double_sigmoid" href="#ml4opf.BoundRepair.double_sigmoid">double_sigmoid</a></code></li>
<li><code><a title="ml4opf.BoundRepair.double_softplus" href="#ml4opf.BoundRepair.double_softplus">double_softplus</a></code></li>
<li><code><a title="ml4opf.BoundRepair.double_tanh" href="#ml4opf.BoundRepair.double_tanh">double_tanh</a></code></li>
<li><code><a title="ml4opf.BoundRepair.forward" href="#ml4opf.BoundRepair.forward">forward</a></code></li>
<li><code><a title="ml4opf.BoundRepair.load_state_dict" href="#ml4opf.BoundRepair.load_state_dict">load_state_dict</a></code></li>
<li><code><a title="ml4opf.BoundRepair.lower_relu" href="#ml4opf.BoundRepair.lower_relu">lower_relu</a></code></li>
<li><code><a title="ml4opf.BoundRepair.lower_softplus" href="#ml4opf.BoundRepair.lower_softplus">lower_softplus</a></code></li>
<li><code><a title="ml4opf.BoundRepair.none" href="#ml4opf.BoundRepair.none">none</a></code></li>
<li><code><a title="ml4opf.BoundRepair.preprocess_bounds" href="#ml4opf.BoundRepair.preprocess_bounds">preprocess_bounds</a></code></li>
<li><code><a title="ml4opf.BoundRepair.relu" href="#ml4opf.BoundRepair.relu">relu</a></code></li>
<li><code><a title="ml4opf.BoundRepair.sigmoid" href="#ml4opf.BoundRepair.sigmoid">sigmoid</a></code></li>
<li><code><a title="ml4opf.BoundRepair.softplus" href="#ml4opf.BoundRepair.softplus">softplus</a></code></li>
<li><code><a title="ml4opf.BoundRepair.tanh" href="#ml4opf.BoundRepair.tanh">tanh</a></code></li>
<li><code><a title="ml4opf.BoundRepair.upper_relu" href="#ml4opf.BoundRepair.upper_relu">upper_relu</a></code></li>
<li><code><a title="ml4opf.BoundRepair.upper_softplus" href="#ml4opf.BoundRepair.upper_softplus">upper_softplus</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.DCModel" href="#ml4opf.DCModel">DCModel</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.DCModel.evaluate_model" href="#ml4opf.DCModel.evaluate_model">evaluate_model</a></code></li>
<li><code><a title="ml4opf.DCModel.predict" href="#ml4opf.DCModel.predict">predict</a></code></li>
<li><code><a title="ml4opf.DCModel.problem" href="#ml4opf.DCModel.problem">problem</a></code></li>
<li><code><a title="ml4opf.DCModel.violation" href="#ml4opf.DCModel.violation">violation</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.DCProblem" href="#ml4opf.DCProblem">DCProblem</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.DCProblem.default_combos" href="#ml4opf.DCProblem.default_combos">default_combos</a></code></li>
<li><code><a title="ml4opf.DCProblem.default_order" href="#ml4opf.DCProblem.default_order">default_order</a></code></li>
<li><code><a title="ml4opf.DCProblem.feasibility_check" href="#ml4opf.DCProblem.feasibility_check">feasibility_check</a></code></li>
<li><code><a title="ml4opf.DCProblem.violation" href="#ml4opf.DCProblem.violation">violation</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.DCViolation" href="#ml4opf.DCViolation">DCViolation</a></code></h4>
<ul class="two-column">
<li><code><a title="ml4opf.DCViolation.angle_difference" href="#ml4opf.DCViolation.angle_difference">angle_difference</a></code></li>
<li><code><a title="ml4opf.DCViolation.balance_residual" href="#ml4opf.DCViolation.balance_residual">balance_residual</a></code></li>
<li><code><a title="ml4opf.DCViolation.calc_violations" href="#ml4opf.DCViolation.calc_violations">calc_violations</a></code></li>
<li><code><a title="ml4opf.DCViolation.dva_bound_residual" href="#ml4opf.DCViolation.dva_bound_residual">dva_bound_residual</a></code></li>
<li><code><a title="ml4opf.DCViolation.objective" href="#ml4opf.DCViolation.objective">objective</a></code></li>
<li><code><a title="ml4opf.DCViolation.ohm_residual" href="#ml4opf.DCViolation.ohm_residual">ohm_residual</a></code></li>
<li><code><a title="ml4opf.DCViolation.pf_bound_residual" href="#ml4opf.DCViolation.pf_bound_residual">pf_bound_residual</a></code></li>
<li><code><a title="ml4opf.DCViolation.pf_from_va" href="#ml4opf.DCViolation.pf_from_va">pf_from_va</a></code></li>
<li><code><a title="ml4opf.DCViolation.pg_bound_residual" href="#ml4opf.DCViolation.pg_bound_residual">pg_bound_residual</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.EDModel" href="#ml4opf.EDModel">EDModel</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.EDModel.evaluate_model" href="#ml4opf.EDModel.evaluate_model">evaluate_model</a></code></li>
<li><code><a title="ml4opf.EDModel.problem" href="#ml4opf.EDModel.problem">problem</a></code></li>
<li><code><a title="ml4opf.EDModel.violation" href="#ml4opf.EDModel.violation">violation</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.EDProblem" href="#ml4opf.EDProblem">EDProblem</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.EDProblem.default_combos" href="#ml4opf.EDProblem.default_combos">default_combos</a></code></li>
<li><code><a title="ml4opf.EDProblem.default_order" href="#ml4opf.EDProblem.default_order">default_order</a></code></li>
<li><code><a title="ml4opf.EDProblem.feasibility_check" href="#ml4opf.EDProblem.feasibility_check">feasibility_check</a></code></li>
<li><code><a title="ml4opf.EDProblem.violation" href="#ml4opf.EDProblem.violation">violation</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.EDViolation" href="#ml4opf.EDViolation">EDViolation</a></code></h4>
<ul class="two-column">
<li><code><a title="ml4opf.EDViolation.balance_residual" href="#ml4opf.EDViolation.balance_residual">balance_residual</a></code></li>
<li><code><a title="ml4opf.EDViolation.calc_violations" href="#ml4opf.EDViolation.calc_violations">calc_violations</a></code></li>
<li><code><a title="ml4opf.EDViolation.objective" href="#ml4opf.EDViolation.objective">objective</a></code></li>
<li><code><a title="ml4opf.EDViolation.pf_bound_residual" href="#ml4opf.EDViolation.pf_bound_residual">pf_bound_residual</a></code></li>
<li><code><a title="ml4opf.EDViolation.pf_from_pdpg" href="#ml4opf.EDViolation.pf_from_pdpg">pf_from_pdpg</a></code></li>
<li><code><a title="ml4opf.EDViolation.pg_bound_residual" href="#ml4opf.EDViolation.pg_bound_residual">pg_bound_residual</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.HyperSimplexRepair" href="#ml4opf.HyperSimplexRepair">HyperSimplexRepair</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.HyperSimplexRepair.forward" href="#ml4opf.HyperSimplexRepair.forward">forward</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.LDFLoss" href="#ml4opf.LDFLoss">LDFLoss</a></code></h4>
<ul class="two-column">
<li><code><a title="ml4opf.LDFLoss.end_epoch" href="#ml4opf.LDFLoss.end_epoch">end_epoch</a></code></li>
<li><code><a title="ml4opf.LDFLoss.forward" href="#ml4opf.LDFLoss.forward">forward</a></code></li>
<li><code><a title="ml4opf.LDFLoss.init_mults" href="#ml4opf.LDFLoss.init_mults">init_mults</a></code></li>
<li><code><a title="ml4opf.LDFLoss.reset_trackers" href="#ml4opf.LDFLoss.reset_trackers">reset_trackers</a></code></li>
<li><code><a title="ml4opf.LDFLoss.start_epoch" href="#ml4opf.LDFLoss.start_epoch">start_epoch</a></code></li>
<li><code><a title="ml4opf.LDFLoss.update" href="#ml4opf.LDFLoss.update">update</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.OPFModel" href="#ml4opf.OPFModel">OPFModel</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.OPFModel.evaluate_model" href="#ml4opf.OPFModel.evaluate_model">evaluate_model</a></code></li>
<li><code><a title="ml4opf.OPFModel.load_from_checkpoint" href="#ml4opf.OPFModel.load_from_checkpoint">load_from_checkpoint</a></code></li>
<li><code><a title="ml4opf.OPFModel.predict" href="#ml4opf.OPFModel.predict">predict</a></code></li>
<li><code><a title="ml4opf.OPFModel.save_checkpoint" href="#ml4opf.OPFModel.save_checkpoint">save_checkpoint</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.OPFProblem" href="#ml4opf.OPFProblem">OPFProblem</a></code></h4>
<ul class="two-column">
<li><code><a title="ml4opf.OPFProblem.default_combos" href="#ml4opf.OPFProblem.default_combos">default_combos</a></code></li>
<li><code><a title="ml4opf.OPFProblem.default_order" href="#ml4opf.OPFProblem.default_order">default_order</a></code></li>
<li><code><a title="ml4opf.OPFProblem.feasibility_check" href="#ml4opf.OPFProblem.feasibility_check">feasibility_check</a></code></li>
<li><code><a title="ml4opf.OPFProblem.make_dataset" href="#ml4opf.OPFProblem.make_dataset">make_dataset</a></code></li>
<li><code><a title="ml4opf.OPFProblem.parse" href="#ml4opf.OPFProblem.parse">parse</a></code></li>
<li><code><a title="ml4opf.OPFProblem.slice_batch" href="#ml4opf.OPFProblem.slice_batch">slice_batch</a></code></li>
<li><code><a title="ml4opf.OPFProblem.slice_tensor" href="#ml4opf.OPFProblem.slice_tensor">slice_tensor</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.OPFViolation" href="#ml4opf.OPFViolation">OPFViolation</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.OPFViolation.SUPPORTED_REDUCTIONS" href="#ml4opf.OPFViolation.SUPPORTED_REDUCTIONS">SUPPORTED_REDUCTIONS</a></code></li>
<li><code><a title="ml4opf.OPFViolation.adjacency_matrix" href="#ml4opf.OPFViolation.adjacency_matrix">adjacency_matrix</a></code></li>
<li><code><a title="ml4opf.OPFViolation.adjacency_matrix_dense" href="#ml4opf.OPFViolation.adjacency_matrix_dense">adjacency_matrix_dense</a></code></li>
<li><code><a title="ml4opf.OPFViolation.branch_from_incidence" href="#ml4opf.OPFViolation.branch_from_incidence">branch_from_incidence</a></code></li>
<li><code><a title="ml4opf.OPFViolation.branch_from_incidence_dense" href="#ml4opf.OPFViolation.branch_from_incidence_dense">branch_from_incidence_dense</a></code></li>
<li><code><a title="ml4opf.OPFViolation.branch_from_to_bus" href="#ml4opf.OPFViolation.branch_from_to_bus">branch_from_to_bus</a></code></li>
<li><code><a title="ml4opf.OPFViolation.branch_incidence" href="#ml4opf.OPFViolation.branch_incidence">branch_incidence</a></code></li>
<li><code><a title="ml4opf.OPFViolation.branch_incidence_dense" href="#ml4opf.OPFViolation.branch_incidence_dense">branch_incidence_dense</a></code></li>
<li><code><a title="ml4opf.OPFViolation.branch_to_incidence" href="#ml4opf.OPFViolation.branch_to_incidence">branch_to_incidence</a></code></li>
<li><code><a title="ml4opf.OPFViolation.branch_to_incidence_dense" href="#ml4opf.OPFViolation.branch_to_incidence_dense">branch_to_incidence_dense</a></code></li>
<li><code><a title="ml4opf.OPFViolation.branch_to_to_bus" href="#ml4opf.OPFViolation.branch_to_to_bus">branch_to_to_bus</a></code></li>
<li><code><a title="ml4opf.OPFViolation.calc_violations" href="#ml4opf.OPFViolation.calc_violations">calc_violations</a></code></li>
<li><code><a title="ml4opf.OPFViolation.clamped_bound_residual" href="#ml4opf.OPFViolation.clamped_bound_residual">clamped_bound_residual</a></code></li>
<li><code><a title="ml4opf.OPFViolation.forward" href="#ml4opf.OPFViolation.forward">forward</a></code></li>
<li><code><a title="ml4opf.OPFViolation.gen_to_bus" href="#ml4opf.OPFViolation.gen_to_bus">gen_to_bus</a></code></li>
<li><code><a title="ml4opf.OPFViolation.generator_incidence" href="#ml4opf.OPFViolation.generator_incidence">generator_incidence</a></code></li>
<li><code><a title="ml4opf.OPFViolation.generator_incidence_dense" href="#ml4opf.OPFViolation.generator_incidence_dense">generator_incidence_dense</a></code></li>
<li><code><a title="ml4opf.OPFViolation.load_incidence" href="#ml4opf.OPFViolation.load_incidence">load_incidence</a></code></li>
<li><code><a title="ml4opf.OPFViolation.load_incidence_dense" href="#ml4opf.OPFViolation.load_incidence_dense">load_incidence_dense</a></code></li>
<li><code><a title="ml4opf.OPFViolation.load_to_bus" href="#ml4opf.OPFViolation.load_to_bus">load_to_bus</a></code></li>
<li><code><a title="ml4opf.OPFViolation.objective" href="#ml4opf.OPFViolation.objective">objective</a></code></li>
<li><code><a title="ml4opf.OPFViolation.reduce_violation" href="#ml4opf.OPFViolation.reduce_violation">reduce_violation</a></code></li>
<li><code><a title="ml4opf.OPFViolation.reduce_violations" href="#ml4opf.OPFViolation.reduce_violations">reduce_violations</a></code></li>
<li><code><a title="ml4opf.OPFViolation.violation_shapes" href="#ml4opf.OPFViolation.violation_shapes">violation_shapes</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.ObjectiveLoss" href="#ml4opf.ObjectiveLoss">ObjectiveLoss</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.ObjectiveLoss.SUPPORTED_REDUCTIONS" href="#ml4opf.ObjectiveLoss.SUPPORTED_REDUCTIONS">SUPPORTED_REDUCTIONS</a></code></li>
<li><code><a title="ml4opf.ObjectiveLoss.forward" href="#ml4opf.ObjectiveLoss.forward">forward</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.PGLearnParser" href="#ml4opf.PGLearnParser">PGLearnParser</a></code></h4>
<ul class="two-column">
<li><code><a title="ml4opf.PGLearnParser.convert_to_float32" href="#ml4opf.PGLearnParser.convert_to_float32">convert_to_float32</a></code></li>
<li><code><a title="ml4opf.PGLearnParser.make_tree" href="#ml4opf.PGLearnParser.make_tree">make_tree</a></code></li>
<li><code><a title="ml4opf.PGLearnParser.open_json" href="#ml4opf.PGLearnParser.open_json">open_json</a></code></li>
<li><code><a title="ml4opf.PGLearnParser.pad_to_dense" href="#ml4opf.PGLearnParser.pad_to_dense">pad_to_dense</a></code></li>
<li><code><a title="ml4opf.PGLearnParser.padval" href="#ml4opf.PGLearnParser.padval">padval</a></code></li>
<li><code><a title="ml4opf.PGLearnParser.parse_h5" href="#ml4opf.PGLearnParser.parse_h5">parse_h5</a></code></li>
<li><code><a title="ml4opf.PGLearnParser.parse_json" href="#ml4opf.PGLearnParser.parse_json">parse_json</a></code></li>
<li><code><a title="ml4opf.PGLearnParser.validate_path" href="#ml4opf.PGLearnParser.validate_path">validate_path</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.SOCModel" href="#ml4opf.SOCModel">SOCModel</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.SOCModel.predict" href="#ml4opf.SOCModel.predict">predict</a></code></li>
<li><code><a title="ml4opf.SOCModel.problem" href="#ml4opf.SOCModel.problem">problem</a></code></li>
<li><code><a title="ml4opf.SOCModel.violation" href="#ml4opf.SOCModel.violation">violation</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.SOCProblem" href="#ml4opf.SOCProblem">SOCProblem</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.SOCProblem.default_combos" href="#ml4opf.SOCProblem.default_combos">default_combos</a></code></li>
<li><code><a title="ml4opf.SOCProblem.default_order" href="#ml4opf.SOCProblem.default_order">default_order</a></code></li>
<li><code><a title="ml4opf.SOCProblem.feasibility_check" href="#ml4opf.SOCProblem.feasibility_check">feasibility_check</a></code></li>
<li><code><a title="ml4opf.SOCProblem.violation" href="#ml4opf.SOCProblem.violation">violation</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ml4opf.SOCViolation" href="#ml4opf.SOCViolation">SOCViolation</a></code></h4>
<ul class="">
<li><code><a title="ml4opf.SOCViolation.angle_difference_residual" href="#ml4opf.SOCViolation.angle_difference_residual">angle_difference_residual</a></code></li>
<li><code><a title="ml4opf.SOCViolation.balance_residual" href="#ml4opf.SOCViolation.balance_residual">balance_residual</a></code></li>
<li><code><a title="ml4opf.SOCViolation.calc_violations" href="#ml4opf.SOCViolation.calc_violations">calc_violations</a></code></li>
<li><code><a title="ml4opf.SOCViolation.flows_from_voltage" href="#ml4opf.SOCViolation.flows_from_voltage">flows_from_voltage</a></code></li>
<li><code><a title="ml4opf.SOCViolation.jabr_residual" href="#ml4opf.SOCViolation.jabr_residual">jabr_residual</a></code></li>
<li><code><a title="ml4opf.SOCViolation.objective" href="#ml4opf.SOCViolation.objective">objective</a></code></li>
<li><code><a title="ml4opf.SOCViolation.pg_bound_residual" href="#ml4opf.SOCViolation.pg_bound_residual">pg_bound_residual</a></code></li>
<li><code><a title="ml4opf.SOCViolation.qg_bound_residual" href="#ml4opf.SOCViolation.qg_bound_residual">qg_bound_residual</a></code></li>
<li><code><a title="ml4opf.SOCViolation.thermal_residual" href="#ml4opf.SOCViolation.thermal_residual">thermal_residual</a></code></li>
<li><code><a title="ml4opf.SOCViolation.w_bound_residual" href="#ml4opf.SOCViolation.w_bound_residual">w_bound_residual</a></code></li>
<li><code><a title="ml4opf.SOCViolation.wi_bound_residual" href="#ml4opf.SOCViolation.wi_bound_residual">wi_bound_residual</a></code></li>
<li><code><a title="ml4opf.SOCViolation.wr_bound_residual" href="#ml4opf.SOCViolation.wr_bound_residual">wr_bound_residual</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.5</a>.</p>
</footer>
</body>
</html>
